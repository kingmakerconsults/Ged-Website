diff --git a/frontend/index.html b/frontend/index.html
index 0b9a5224b21d335e2f58383e1d37aaa6a968bd15..1d76c935ad9fd53b50280160f48ad344b5b919c6 100644
--- a/frontend/index.html
+++ b/frontend/index.html
@@ -12355,239 +12355,332 @@ function FormulaSheetModal({ onClose }) {
                     <div>
                         <h3 className="formula-sheet-section text-lg font-bold border-b mb-2">Volume</h3>
                         <Formula title="Cube" formula="V = s^3" />
                         <Formula title="Rectangular Prism" formula="V = lwh" />
                         <Formula title="Cylinder" formula="V = \\pi r^2 h" />
                         <Formula title="Pyramid" formula="V = \\\\frac{1}{3}Bh" description="B = area of base" />
                         <Formula title="Cone" formula="V = \\\\frac{1}{3}\\\\pi r^2 h" />
                         <Formula title="Sphere" formula="V = \\\\frac{4}{3}\\\\pi r^3" />
 
                         <h3 className="formula-sheet-section text-lg font-bold border-b mt-4 mb-2">Data</h3>
                         <Formula title="Mean" formula="mean = \\\\frac{\\\\text{sum of values}}{\\\\text{number of values}}" />
                         <Formula title="Median" formula="median = \\\\text{middle value of an ordered data set}" />
                     </div>
                 </div>
             </div>
         </div>
     );
 }
 
 function StartScreen({ currentUser, onLogout, progress, profileBundle: profileData, testDate, onboardingComplete, onShowProfile, onSelectQuiz, vocabulary, onSelectGenerator, onStartPopQuiz, onStartComprehensiveExam, setIsLoading, setLoadingMessage, setShowFormulaSheet, onOpenMathTools, theme = 'light', onRefreshProfile }) {
     const [selectedSubject, setSelectedSubject] = useState(null);
     const [selectedCategory, setSelectedCategory] = useState(null);
     const [aiQuizTopic, setAiQuizTopic] = useState('');
     const [detailedViewSubject, setDetailedViewSubject] = useState(null);
     // weekly coach
-    const [coachPlan, setCoachPlan] = useState(null);
+    const [weeklyCoachPlan, setWeeklyCoachPlan] = useState(null);
     const [coachLoading, setCoachLoading] = useState(false);
     const [coachError, setCoachError] = useState('');
 
-    // daily coach
+    // daily coach progress snapshot
     const [dailyLoading, setDailyLoading] = useState(false);
     const [dailyError, setDailyError] = useState('');
-    const [dailyToday, setDailyToday] = useState('');
-    const [dailySubjects, setDailySubjects] = useState([]);
+    const [coachDailySubjects, setCoachDailySubjects] = useState([]);
     // weekly coach summary for dashboard
-    const [weeklySubjects, setWeeklySubjects] = useState([]);
+    const [weeklyCoachSummary, setWeeklyCoachSummary] = useState([]);
     const [generatingAll, setGeneratingAll] = useState(false);
     // Vocabulary collapsible
     const [vocabOpen, setVocabOpen] = useState(true);
 
     // Ask Coach (advice)
     const [adviceLoading, setAdviceLoading] = useState(false);
     const [adviceText, setAdviceText] = useState('');
     const [adviceError, setAdviceError] = useState('');
 
-    // Weekly coach helpers (top-level)
-    const loadCoachPlan = async () => {
+    const canonicalSubjectId = (value) => {
+        const str = (value || '').toString().toLowerCase();
+        if (!str) return '';
+        if (str.startsWith('math')) return 'math';
+        if (str.startsWith('science')) return 'science';
+        if (str === 'rla' || str.includes('language')) return 'rla';
+        if (str.includes('social')) return 'social_studies';
+        return str.replace(/[^a-z0-9]+/g, '_');
+    };
+
+    const displaySubjectName = (value) => {
+        const id = canonicalSubjectId(value);
+        if (id === 'rla') return 'Reasoning Through Language Arts (RLA)';
+        if (id === 'social_studies') return 'Social Studies';
+        if (id === 'math') return 'Math';
+        if (id === 'science') return 'Science';
+        return value || 'Subject';
+    };
+
+    const practiceSubjectParam = (value) => {
+        const id = canonicalSubjectId(value);
+        if (!id) return '';
+        if (id === 'math') return 'math';
+        if (id === 'science') return 'science';
+        if (id === 'rla') return 'rla';
+        return 'social-studies';
+    };
+
+    const addDaysToDate = (iso, offset = 0) => {
+        if (!iso) return null;
+        try {
+            const base = new Date(`${iso}T00:00:00`);
+            const shifted = new Date(base.getTime() + offset * 24 * 60 * 60 * 1000);
+            return shifted.toISOString().slice(0, 10);
+        } catch {
+            return null;
+        }
+    };
+
+    const normalizeCoachTask = (task = {}, dayFallback = {}, dayIndex = 0, taskIndex = 0) => {
+        const rawSubject = task.subject || dayFallback.subject || dayFallback.subjectLabel || '';
+        const subjectId = canonicalSubjectId(rawSubject);
+        const subjectLabel = task.subjectLabel || dayFallback.subjectLabel || displaySubjectName(rawSubject || subjectId);
+        const focus = Array.isArray(task.focus) ? task.focus : (task.focus ? [task.focus] : []);
+        const minutesFromTask = Number(task.minutes);
+        const minutesFallback = Number(dayFallback.minutes);
+        return {
+            id: task.id || `${subjectId || 'task'}-${dayIndex}-${taskIndex}`,
+            subject: subjectId,
+            subjectLabel,
+            title: task.title || task.label || dayFallback.label || dayFallback.task || task.type || 'Practice',
+            type: task.type || dayFallback.type || 'practice',
+            minutes: Number.isFinite(minutesFromTask) ? minutesFromTask : (Number.isFinite(minutesFallback) ? minutesFallback : 20),
+            quizId: task.quizId || task.quizCode || null,
+            quizPath: task.quizPath || null,
+            focus,
+            message: task.message || dayFallback.message || null,
+        };
+    };
+
+    const adaptWeeklyCoachResponse = (raw) => {
+        if (!raw) return { weekStart: null, weekEnd: null, days: [] };
+        const plan = raw.plan || raw;
+        const weekStart = plan.weekStart || raw.weekStart || null;
+        const weekEnd = plan.weekEnd || raw.weekEnd || null;
+        const daysInput = Array.isArray(plan.days) ? plan.days : [];
+        const normalizedDays = daysInput.map((day, idx) => {
+            const dayNumber = Number(day.day);
+            const resolvedIndex = Number.isFinite(dayNumber) && dayNumber >= 1 ? dayNumber - 1 : idx;
+            const label = day.label || `Day ${resolvedIndex + 1}`;
+            const date = day.date || addDaysToDate(weekStart, resolvedIndex);
+            const tasks = Array.isArray(day.tasks) ? day.tasks.map((task, taskIndex) => normalizeCoachTask(task, day, resolvedIndex, taskIndex)) : [];
+            return {
+                day: resolvedIndex + 1,
+                label,
+                date,
+                tasks,
+            };
+        });
+        return {
+            weekStart,
+            weekEnd,
+            generatedAt: plan.generatedAt || null,
+            subjects: plan.subjects || {},
+            days: normalizedDays,
+        };
+    };
+
+    const getTodayIndex = (weekStartISO) => {
+        if (!weekStartISO) return -1;
+        try {
+            const today = new Date();
+            const localToday = new Date(today.getFullYear(), today.getMonth(), today.getDate());
+            const start = new Date(weekStartISO + 'T00:00:00');
+            const diff = Math.floor((localToday - start) / (24 * 60 * 60 * 1000));
+            if (diff < 0 || diff > 6) return -1;
+            return diff;
+        } catch {
+            return -1;
+        }
+    };
+
+    const fetchWeeklyCoachPlan = async () => {
         try {
             setCoachLoading(true);
             setCoachError('');
             const token = (typeof localStorage !== 'undefined' && localStorage.getItem('appToken')) || null;
-            if (!token) { setCoachPlan(null); return; }
-            const subjectParam = selectedSubject === 'Reasoning Through Language Arts (RLA)' ? 'RLA' : selectedSubject;
-            if (!subjectParam) { setCoachPlan(null); return; }
-            const res = await fetch(`${API_BASE_URL}/api/coach/${encodeURIComponent(subjectParam)}`, {
-                headers: { Authorization: `Bearer ${token}` }
-            });
+            if (!token) {
+                setWeeklyCoachPlan(null);
+                setWeeklyCoachSummary([]);
+                return;
+            }
+            const res = await fetch(`${API_BASE_URL}/api/coach/weekly`, { headers: { Authorization: `Bearer ${token}` } });
+            if (!res.ok) {
+                setWeeklyCoachPlan((prev) => prev || { weekStart: null, weekEnd: null, days: [] });
+                if (res.status !== 404) setCoachError('Unable to load weekly coach plan.');
+                return;
+            }
+            const data = await res.json();
+            const normalized = adaptWeeklyCoachResponse(data);
+            setWeeklyCoachPlan(normalized);
+            setWeeklyCoachSummary(Array.isArray(data?.subjects) ? data.subjects : []);
+        } catch (e) {
+            setCoachError('Unable to load weekly coach plan.');
+            setWeeklyCoachPlan((prev) => prev || { weekStart: null, weekEnd: null, days: [] });
+        } finally {
+            setCoachLoading(false);
+        }
+    };
+
+    const fetchCoachDailyProgress = async () => {
+        try {
+            setDailyLoading(true);
+            setDailyError('');
+            const token = (typeof localStorage !== 'undefined' && localStorage.getItem('appToken')) || null;
+            if (!token) {
+                setCoachDailySubjects([]);
+                return;
+            }
+            const res = await fetch(`${API_BASE_URL}/api/coach/daily`, { headers: { Authorization: `Bearer ${token}` } });
             if (res.ok) {
                 const data = await res.json();
-                if (data && data.ok && data.plan) setCoachPlan(data.plan);
-                else setCoachPlan(null);
+                if (data && data.ok) {
+                    setCoachDailySubjects(Array.isArray(data.subjects) ? data.subjects : []);
+                } else {
+                    setCoachDailySubjects([]);
+                }
             } else {
-                setCoachPlan(null);
+                setDailyError("Unable to load today's coach goals.");
             }
         } catch (e) {
-            setCoachError('Unable to load coach plan.');
+            setDailyError("Unable to load today's coach goals.");
         } finally {
-            setCoachLoading(false);
+            setDailyLoading(false);
         }
     };
+
+    const refreshCoachPanels = async () => {
+        await Promise.all([fetchWeeklyCoachPlan(), fetchCoachDailyProgress()]);
+    };
+
     const generateCoachPlan = async () => {
         try {
             setCoachLoading(true);
             setCoachError('');
             const token = (typeof localStorage !== 'undefined' && localStorage.getItem('appToken')) || null;
             if (!token) { alert('Please sign in to generate a weekly plan.'); return; }
-            const subjectParam = selectedSubject === 'Reasoning Through Language Arts (RLA)' ? 'RLA' : selectedSubject;
+            const subjectParam = practiceSubjectParam(selectedSubject);
             if (!subjectParam) { alert('Pick a subject first.'); return; }
-            const res = await fetch(`${API_BASE_URL}/api/coach/${encodeURIComponent(subjectParam)}/generate-week`, {
+            const apiSubject = subjectParam === 'social-studies' ? 'Social Studies' : (subjectParam === 'rla' ? 'RLA' : subjectParam.charAt(0).toUpperCase() + subjectParam.slice(1));
+            const res = await fetch(`${API_BASE_URL}/api/coach/${encodeURIComponent(apiSubject)}/generate-week`, {
                 method: 'POST',
                 headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
             });
             if (res.ok) {
-                const data = await res.json();
-                if (data && data.ok && data.plan) setCoachPlan(data.plan);
-                // Refresh daily + weekly cards so Today and dashboard reflect the new plan immediately
                 await refreshCoachPanels();
-                // Also refresh the subject's own weekly panel explicitly
-                await loadCoachPlan();
             } else if (res.status === 429) {
                 const data = await res.json().catch(() => ({}));
                 setCoachError(data?.message || 'You already generated the weekly plan for this subject this week.');
                 alert(data?.message || 'You already generated the weekly plan for this subject this week.');
             } else {
                 setCoachError('Failed to generate plan.');
             }
         } catch (e) {
             setCoachError('Failed to generate plan.');
         } finally {
             setCoachLoading(false);
         }
     };
 
-    // Generate weekly plans for all subjects, then refresh weekly summary
     const generateAllWeeklyPlans = async () => {
         try {
             const token = (typeof localStorage !== 'undefined' && localStorage.getItem('appToken')) || null;
             if (!token) { alert('Please sign in to generate weekly plans.'); return; }
             setGeneratingAll(true);
             const subjects = ['Math', 'RLA', 'Science', 'Social Studies'];
             const results = [];
             for (const subj of subjects) {
                 try {
                     const res = await fetch(`${API_BASE_URL}/api/coach/${encodeURIComponent(subj)}/generate-week`, {
                         method: 'POST',
                         headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
                     });
                     if (res.status === 429) {
                         const data = await res.json().catch(() => ({}));
                         results.push(`${subj}: already generated`);
                         continue;
                     }
                     if (!res.ok) {
                         results.push(`${subj}: error (${res.status})`);
                         continue;
                     }
                     results.push(`${subj}: ok`);
                 } catch (e) {
                     results.push(`${subj}: error`);
                 }
             }
-            // Refresh both daily and weekly so panels reflect new plans immediately
             await refreshCoachPanels();
-            // Optional toast via alert for now
             if (results.length) alert(results.join('\n'));
         } finally {
             setGeneratingAll(false);
         }
     };
-    useEffect(() => { if (selectedSubject) loadCoachPlan(); }, [selectedSubject]);
 
-    // Daily coach loader (top-level) and weekly summary loader
     useEffect(() => {
         (async () => {
-            try {
-                setDailyLoading(true);
-                setDailyError('');
-                const token = (typeof localStorage !== 'undefined' && localStorage.getItem('appToken')) || null;
-                if (!token) { setDailyToday(''); setDailySubjects([]); setWeeklySubjects([]); return; }
-                const res = await fetch(`${API_BASE_URL}/api/coach/daily`, { headers: { Authorization: `Bearer ${token}` } });
-                if (res.ok) {
-                    const data = await res.json();
-                    if (data && data.ok) {
-                        setDailyToday(data.today || '');
-                        setDailySubjects(Array.isArray(data.subjects) ? data.subjects : []);
-                    } else {
-                        setDailyToday('');
-                        setDailySubjects([]);
-                    }
-                } else {
-                    setDailyError("Unable to load today's coach goals.");
-                }
-                // Weekly
-                try {
-                    const rw = await fetch(`${API_BASE_URL}/api/coach/weekly`, { headers: { Authorization: `Bearer ${token}` } });
-                    if (rw.ok) {
-                        const dw = await rw.json();
-                        setWeeklySubjects(Array.isArray(dw?.subjects) ? dw.subjects : []);
-                    } else {
-                        setWeeklySubjects([]);
-                    }
-                } catch (_) {
-                    setWeeklySubjects([]);
-                }
-            } catch (e) {
-                setDailyError("Unable to load today's coach goals.");
-            } finally {
-                setDailyLoading(false);
-            }
+            await fetchWeeklyCoachPlan();
+            await fetchCoachDailyProgress();
         })();
     }, []);
 
-    // Shared helpers used by coach panels/buttons
-    const displaySubjectName = (s) => (s === 'RLA' ? 'Reasoning Through Language Arts (RLA)' : s);
-    const practiceSubjectParam = (s) => {
-        const key = (s || '').toLowerCase();
-        if (key.startsWith('math')) return 'math';
-        if (key.startsWith('science')) return 'science';
-        if (key === 'rla' || key.includes('language')) return 'rla';
-        return 'social-studies';
-    };
-
-    // Refresh both daily and weekly coach panels on demand
-    const refreshCoachPanels = async () => {
-        const token = (typeof localStorage !== 'undefined' && localStorage.getItem('appToken')) || null;
-        if (!token) return;
-        try {
-            const resDaily = await fetch(`${API_BASE_URL}/api/coach/daily`, { headers: { Authorization: `Bearer ${token}` } });
-            if (resDaily.ok) {
-                const d = await resDaily.json();
-                if (d && d.ok) {
-                    setDailyToday(d.today || '');
-                    setDailySubjects(Array.isArray(d.subjects) ? d.subjects : []);
-                }
-            }
-        } catch (_) {}
-        try {
-            const resWeekly = await fetch(`${API_BASE_URL}/api/coach/weekly`, { headers: { Authorization: `Bearer ${token}` } });
-            if (resWeekly.ok) {
-                const dw = await resWeekly.json();
-                setWeeklySubjects(Array.isArray(dw?.subjects) ? dw.subjects : []);
+    const todaysTasks = React.useMemo(() => {
+        if (!weeklyCoachPlan || !Array.isArray(weeklyCoachPlan?.days) || weeklyCoachPlan.days.length === 0) return [];
+        let idx = getTodayIndex(weeklyCoachPlan.weekStart);
+        if (idx < 0 || idx >= weeklyCoachPlan.days.length) idx = 0;
+        const day = weeklyCoachPlan.days[idx];
+        return Array.isArray(day.tasks) ? day.tasks : [];
+    }, [weeklyCoachPlan]);
+
+    const todaysTaskGroups = React.useMemo(() => {
+        const groups = new Map();
+        todaysTasks.forEach((task) => {
+            if (!task) return;
+            const subjectId = canonicalSubjectId(task.subject || task.subjectLabel || '');
+            const subjectLabel = displaySubjectName(task.subjectLabel || task.subject);
+            if (!groups.has(subjectId)) {
+                groups.set(subjectId, { subjectId, subjectLabel, tasks: [] });
             }
-        } catch (_) {}
-    };
+            groups.get(subjectId).tasks.push(task);
+        });
+        return Array.from(groups.values());
+    }, [todaysTasks]);
+
+    const dailyProgressMap = React.useMemo(() => {
+        const map = new Map();
+        (Array.isArray(coachDailySubjects) ? coachDailySubjects : []).forEach((entry) => {
+            if (!entry) return;
+            const id = canonicalSubjectId(entry.subject);
+            map.set(id, entry);
+        });
+        return map;
+    }, [coachDailySubjects]);
+
     // Resolve and launch a premade by quizCode for a subject (global helper)
     const launchPremadeByCodeGlobal = (subject, quizCode) => {
         try {
             const data = (typeof window !== 'undefined') ? (window.MergedExpandedQuizData || window.ExpandedQuizData || {}) : {};
             const subjectData = data?.[displaySubjectName(subject)] || data?.[subject] || null;
             if (!subjectData) throw new Error('Subject dataset not found');
             let found = null;
             const setIfMatch = (obj) => {
                 if (found) return; if (!obj) return;
                 if (obj.quizCode && obj.quizCode === quizCode) found = obj;
             };
             if (Array.isArray(subjectData.quizzes)) subjectData.quizzes.forEach(setIfMatch);
             const cats = subjectData.categories || {};
             for (const catName of Object.keys(cats)) {
                 const cat = cats[catName]; if (!cat) continue;
                 if (Array.isArray(cat.quizzes)) cat.quizzes.forEach(setIfMatch);
                 const topics = Array.isArray(cat.topics) ? cat.topics : [];
                 for (const t of topics) {
                     setIfMatch(t);
                     if (Array.isArray(t?.quizzes)) t.quizzes.forEach(setIfMatch);
                 }
             }
             if (!found) throw new Error('not_found');
             const baseTitle = found.title || 'Premade Quiz';
             let questions = [];
@@ -12608,50 +12701,80 @@ function StartScreen({ currentUser, onLogout, progress, profileBundle: profileDa
                     questions = originTopic.questions;
                 } else if (originTopic && Array.isArray(originTopic.quizzes)) {
                     const match = originTopic.quizzes.find(q => q.quizCode === found.quizCode || q.quizId === found.quizId) || originTopic.quizzes[0];
                     if (match && Array.isArray(match.questions)) questions = match.questions;
                 }
             }
             const normalized = (questions || []).map((q, i) => normalizeQuestionAssets(q && typeof q === 'object' ? { ...q, questionNumber: q.questionNumber ?? (i + 1) } : q, displaySubjectName(subject)));
             const payload = {
                 ...found,
                 id: found.quizCode || found.quizId || baseTitle,
                 quizCode: found.quizCode || found.quizId || baseTitle,
                 title: baseTitle,
                 type: found.type || 'quiz',
                 questions: normalized,
                 isPremade: true,
                 assignedBy: 'coach-smith',
             };
             startQuiz(payload, displaySubjectName(subject));
             return true;
         } catch (e) {
             console.warn('launchPremadeByCodeGlobal failed', subject, quizCode, e);
             return false;
         }
     };
 
+    const openCoachTask = (task) => {
+        if (!task) return;
+        const subjectLabel = displaySubjectName(task.subjectLabel || task.subject);
+        const subjectId = canonicalSubjectId(task.subject || task.subjectLabel || '');
+        if (task.type === 'coach-quiz') {
+            const progress = dailyProgressMap.get(subjectId);
+            const sourceId = progress?.coach_quiz_source_id || task.quizId || null;
+            startCoachQuizForSubject(subjectLabel, sourceId);
+            return;
+        }
+        if (task.quizId) {
+            const launched = launchPremadeByCodeGlobal(subjectLabel, task.quizId);
+            if (!launched) {
+                if (task.quizPath) {
+                    window.location.href = task.quizPath;
+                } else {
+                    alert('Unable to open this quiz right now.');
+                }
+            }
+            return;
+        }
+        if (task.quizPath) {
+            window.location.href = task.quizPath;
+            return;
+        }
+        if (task.message) {
+            alert(task.message);
+        }
+    };
+
     const startCoachQuizForSubject = async (subject, sourceId) => {
         try {
             const token = (typeof localStorage !== 'undefined' && localStorage.getItem('appToken')) || null;
             if (!token) { alert('Please sign in to take today\'s coach quiz.'); return; }
             setIsLoading(true);
             setLoadingMessage(`Loading Coach Smith quiz for ${subject}...`);
             if (sourceId) {
                 // If a premade assignment exists, launch it directly
                 const launched = launchPremadeByCodeGlobal(subject, sourceId);
                 if (launched) return; // early exit; loader will be dismissed in finally
             }
             const body = {
                 durationMinutes: 20,
                 mode: 'single-subject',
                 subject: practiceSubjectParam(subject)
             };
             const res = await fetch(`${API_BASE_URL}/api/practice-session`, {
                 method: 'POST',
                 headers: { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` },
                 body: JSON.stringify(body)
             });
             if (!res.ok) {
                 throw new Error(`Server responded ${res.status}`);
             }
             const session = await res.json();
@@ -12976,51 +13099,56 @@ function StartScreen({ currentUser, onLogout, progress, profileBundle: profileDa
         const pt = profileData?.profile?.tests;
         if (pt && typeof pt === 'object') {
             Object.entries(pt).forEach(([key, val]) => {
                 if (!val) return;
                 const id = key;
                 if (val.passed === true || val.isPassed === true) map[id] = true;
             });
         }
         return map;
     }, [profileData?.testPlan, profileData?.profile?.tests]);
     const progressPassedMap = useMemo(() => {
         const map = {};
         const subjectNames = Object.keys(SUBJECT_ID_MAP);
         subjectNames.forEach((label) => {
             const id = SUBJECT_ID_MAP[label];
             const p = progress?.[label] || {};
             const passedCount = Array.isArray(p?.passedExamCodes) ? p.passedExamCodes.length : (typeof p?.completedCount === 'number' ? p.completedCount : 0);
             if (passedCount > 0) map[id] = true;
         });
         return map;
     }, [progress]);
     // Self-declared "already passed" check: require all four subjects to be marked passed in profile/test plan
     const allSubjectsSelfDeclaredPassed = useMemo(() => {
         try {
             const required = ['math', 'rla', 'science', 'social_studies'];
-            return required.every((id) => profilePassedMap && profilePassedMap[id] === true);
+            if (!profilePassedMap || typeof profilePassedMap !== 'object') return false;
+            let count = 0;
+            for (const id of required) {
+                if (profilePassedMap[id] === true) count += 1;
+            }
+            return count === required.length;
         } catch {
             return false;
         }
     }, [profilePassedMap]);
     const earnedBadges = useMemo(() => {
         const ids = new Set();
         Object.entries(profilePassedMap).forEach(([id, val]) => { if (val) ids.add(id); });
         Object.entries(progressPassedMap).forEach(([id, val]) => { if (val) ids.add(id); });
         const order = ['math', 'rla', 'science', 'social_studies'];
         return order
             .filter((id) => ids.has(id))
             .map((id) => ({
                 id,
                 label: id === 'rla' ? 'Reasoning Through Language Arts (RLA)' : (id === 'social_studies' ? 'Social Studies' : id.charAt(0).toUpperCase() + id.slice(1).replace('_', ' ')),
                 img: BADGE_IMG_PATHS[id]
             }));
     }, [profilePassedMap, progressPassedMap]);
 
     // Restore: clicking a subject opens its premade list view (do not auto-start a quiz)
     const openSubjectPremades = (subjectLabel) => {
         const subjectKey = subjectLabel; // labels already match keys in AppData
         handleSelectSubject(subjectKey);
     };
 
     // Compute RLA essay avg display for details view
@@ -13508,177 +13636,206 @@ function StartScreen({ currentUser, onLogout, progress, profileBundle: profileDa
                                         }}
                                     >
                                         View Science Formula Sheet
                                     </button>
                                 )}
                             </div>
                         )}
                     </div>
                     {subjectVocabulary.length > 0 && (
                         <SubjectVocabularySection
                             subject={selectedSubject}
                             words={subjectVocabulary}
                             theme={theme}
                         />
                     )}
                     {/* Daily Coach goals (across subjects) */}
                     <div className={`coach-panel rounded-lg p-4 mt-4 shadow-md ${isDarkMode ? '' : 'coach-gold-light'}`}>
                         <div className="flex items-center justify-center gap-2" style={{ color: heroAccentColor }}>
                             <CalendarIcon className="h-8 w-8" />
                             <h3 className="text-xl font-bold" style={{ color: heroTextColor }}>Today&apos;s Coach Goals</h3>
                         </div>
                         {dailyLoading ? (
                             <p className="text-center text-sm mt-2" style={heroMutedTextStyle}>Loading…</p>
                         ) : dailyError ? (
                             <p className="text-center text-sm mt-2 text-red-600">{dailyError}</p>
-                        ) : Array.isArray(dailySubjects) && dailySubjects.length ? (
+                        ) : todaysTaskGroups.length ? (
                             <div className="mt-3 space-y-3">
-                                {dailySubjects.map((ds, idx) => (
-                                    <div key={idx} className="border rounded-md p-3" style={{ borderColor: panelBorderColor }}>
-                                        <div className="flex items-center justify-between">
-                                            <div>
-                                                <div className="font-semibold" style={{ color: heroTextColor }}>{displaySubjectName(ds.subject)}</div>
-                                                <div className="text-sm" style={heroMutedTextStyle}>
-                                                    {Math.max(0, ds.completed_minutes || 0)} / {ds.expected_minutes || 45} minutes
+                                {todaysTaskGroups.map((group) => {
+                                    const progress = dailyProgressMap.get(group.subjectId) || {};
+                                    return (
+                                        <div key={group.subjectId || group.subjectLabel} className="border rounded-md p-3" style={{ borderColor: panelBorderColor }}>
+                                            <div className="flex items-center justify-between gap-3">
+                                                <div>
+                                                    <div className="font-semibold" style={{ color: heroTextColor }}>{group.subjectLabel}</div>
+                                                    <div className="text-sm" style={heroMutedTextStyle}>
+                                                        {Math.max(0, progress.completed_minutes || 0)} / {progress.expected_minutes || 45} minutes
+                                                    </div>
                                                 </div>
-                                            </div>
-                                            <div className="flex justify-end">
-                                                {ds.coach_quiz_id ? (
-                                                    ds.coach_quiz_completed ? (
+                                                {progress.coach_quiz_id && (
+                                                    progress.coach_quiz_completed ? (
                                                         <span className="text-sm px-3 py-1 rounded-full" style={{ backgroundColor: isDarkMode ? 'rgba(34,197,94,0.2)' : '#dcfce7', color: '#166534' }}>Coach Quiz Done</span>
-                                                    ) : (
-                                                        <button
-                                                            onClick={() => startCoachQuizForSubject(ds.subject, ds.coach_quiz_source_id)}
-                                                            className="px-8 py-4 bg-purple-600 text-white font-bold rounded-lg shadow-lg hover:bg-purple-700 transition-transform transform hover:scale-105 quiz-start-btn"
-                                                        >
-                                                            Take Today&apos;s Coach Smith Quiz
-                                                        </button>
-                                                    )
-                                                ) : null}
+                                                    ) : null
+                                                )}
                                             </div>
-                                        </div>
-                                        {Array.isArray(ds.tasks) && ds.tasks.length ? (
-                                            <ul className="mt-2 list-disc ml-5 text-sm" style={heroMutedTextStyle}>
-                                                {ds.tasks.map((t, i) => {
-                                                    const text = (t && typeof t === 'object') ? (t.label || t.type || '') : (t || '');
-                                                    return <li key={i}>{text}</li>;
+                                            <div className="mt-3 space-y-2">
+                                                {group.tasks.map((task) => {
+                                                    const focusText = Array.isArray(task.focus) && task.focus.length ? `Focus: ${task.focus.join(', ')}` : '';
+                                                    const buttonLabel = task.type === 'coach-quiz'
+                                                        ? `Start Coach Quiz`
+                                                        : task.quizId || task.quizPath
+                                                            ? `Start ${group.subjectLabel.split(' ')[0]} Practice`
+                                                            : '';
+                                                    return (
+                                                        <div key={task.id} className="rounded-md border px-3 py-2" style={{ borderColor: panelBorderColor }}>
+                                                            <div className="flex items-start justify-between gap-3">
+                                                                <div>
+                                                                    <div className="font-medium" style={{ color: heroTextColor }}>{task.title}</div>
+                                                                    {focusText ? <div className="text-xs" style={heroMutedTextStyle}>{focusText}</div> : null}
+                                                                    {task.message ? (
+                                                                        <p className="text-sm mt-1" style={heroMutedTextStyle}>{task.message}</p>
+                                                                    ) : null}
+                                                                </div>
+                                                                <span className="text-xs font-semibold" style={heroMutedTextStyle}>{task.minutes} min</span>
+                                                            </div>
+                                                            {buttonLabel && (
+                                                                <button
+                                                                    onClick={() => openCoachTask(task)}
+                                                                    className="mt-2 px-4 py-2 bg-purple-600 text-white text-sm font-semibold rounded-md shadow-sm hover:bg-purple-700 transition"
+                                                                >
+                                                                    {buttonLabel}
+                                                                </button>
+                                                            )}
+                                                        </div>
+                                                    );
                                                 })}
-                                            </ul>
-                                        ) : null}
-                                    </div>
-                                ))}
+                                            </div>
+                                        </div>
+                                    );
+                                })}
                             </div>
                         ) : (
                             <p className="text-center text-sm mt-2" style={heroMutedTextStyle}>No goals for today yet.</p>
                         )}
                         {/* Ask Coach (parked) */}
                         <div className="mt-4 border rounded-md p-3" style={{ borderColor: panelBorderColor, backgroundColor: isDarkMode ? 'rgba(15,23,42,0.5)' : 'rgba(255,255,255,0.7)', display: 'none' }}>
                             <div className="flex items-center gap-2 mb-2" style={{ color: heroTextColor }}>
                                 <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" className="w-5 h-5"><path d="M12 2a9 9 0 00-9 9c0 4.418 3.134 8.09 7.25 8.848V22l3.5-2H14a9 9 0 000-18z"/></svg>
                                 <span className="text-sm font-medium">Ask Coach for a {selectedSubject ? selectedSubject : 'subject'} tip</span>
                             </div>
                             <div className="flex items-center gap-2">
                                 <button
                                     disabled
                                     className="px-3 py-2 text-sm font-semibold rounded-md transition"
                                     style={{ backgroundColor: '#ffffff', color: '#0f172a', opacity: adviceLoading ? 0.6 : 1 }}
                                 >
                                     {adviceLoading ? 'Asking…' : 'Ask Coach'}
                                 </button>
                                 {adviceError && <span className="text-xs text-red-600">{adviceError}</span>}
                             </div>
                             {adviceText && (
                                 <div className="mt-2 text-sm whitespace-pre-wrap" style={{ color: heroTextColor }}>{adviceText}</div>
                             )}
                             <p className="mt-2 text-xs" style={heroMutedTextStyle}>2 tips per week per student. Tester account is unlimited.</p>
                         </div>
                     </div>
 
                     {/* New clustered quiz browser */}
                     <SubjectQuizBrowser subjectName={selectedSubject} onSelectQuiz={onSelectQuiz} theme={theme} />
                     {/* Keep generator and comprehensive exam below the cluster UI */}
                     {(selectedSubject === 'Social Studies' || selectedSubject === 'Reasoning Through Language Arts (RLA)' || selectedSubject === 'Science' || selectedSubject === 'Math') && (
                         <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
                             {(() => {
                                 const subj = selectedSubject;
-                                const subjectKey = (subj === 'Math') ? 'math' : (subj === 'Science' ? 'science' : (subj?.startsWith('Reasoning') ? 'rla' : 'social'));
-                                const match = Array.isArray(weeklySubjects)
-                                    ? weeklySubjects.find((ws) => (subj?.startsWith('Reasoning') ? (ws.subject === 'RLA' || ws.subject === subj) : ws.subject === subj))
+                                const subjectId = canonicalSubjectId(subj);
+                                const subjectKey = subjectId === 'science' ? 'science' : subjectId === 'math' ? 'math' : subjectId === 'rla' ? 'rla' : 'social';
+                                const match = Array.isArray(weeklyCoachSummary)
+                                    ? weeklyCoachSummary.find((ws) => canonicalSubjectId(ws.subject) === subjectId || (subjectId === 'rla' && canonicalSubjectId(ws.subject) === 'rla'))
                                     : null;
                                 const completed = Math.max(0, match?.completed_minutes_week || 0);
-                                const fallbackTarget = (coachPlan && coachPlan.plan_json && Array.isArray(coachPlan.plan_json.days))
-                                    ? coachPlan.plan_json.days.reduce((acc, d) => acc + (Number(d.minutes) || 0), 0)
-                                    : 140;
+                                const subjectPlanDays = Array.isArray(weeklyCoachPlan?.days)
+                                    ? weeklyCoachPlan.days
+                                        .map((day) => ({
+                                            ...day,
+                                            tasks: Array.isArray(day.tasks)
+                                                ? day.tasks.filter((task) => canonicalSubjectId(task.subject || task.subjectLabel || '') === subjectId)
+                                                : []
+                                        }))
+                                        .filter((day) => day.tasks.length > 0)
+                                    : [];
+                                const fallbackTarget = subjectPlanDays.reduce((acc, day) => acc + day.tasks.reduce((sum, task) => sum + (Number(task.minutes) || 0), 0), 0) || 140;
                                 const target = match?.expected_minutes_week || fallbackTarget;
+                                const hasPlan = subjectPlanDays.length > 0;
                                 return (
                                     <div
                                         className={`coach-panel ${theme === 'dark' ? '' : 'coach-gold-light'} coach-subject-card subject-${subjectKey} rounded-lg p-4 flex flex-col justify-between shadow-md hover:shadow-lg transition-all`}
                                     >
                                 <div>
                                     <div className="flex items-center justify-between mb-2">
                                         <p className="subject-pill text-xs font-semibold uppercase tracking-wide" style={{ borderRadius: '9999px', padding: '2px 10px' }}>
                                             {subj?.startsWith('Reasoning') ? 'RLA' : subj}
                                         </p>
                                         <span className="minutes-pill text-[0.70rem]">{completed} / {target} min</span>
                                     </div>
                                     <div className="flex items-center justify-center gap-2" style={{ color: heroAccentColor }}>
                                         <CalendarIcon className="h-8 w-8" />
                                         <h3 className="text-xl font-bold" style={{ color: heroTextColor }}>Weekly Coach</h3>
                                     </div>
                                     <p className="text-sm my-2 text-center" style={heroMutedTextStyle}>
                                         A 7-day plan tailored to your recent progress.
                                     </p>
                                     {coachLoading ? (
                                         <p className="text-center text-sm" style={heroMutedTextStyle}>Loading…</p>
-                                    ) : coachPlan && coachPlan.plan_json && Array.isArray(coachPlan.plan_json.days) ? (
+                                    ) : hasPlan ? (
                                         <div className="mt-2 max-h-48 overflow-y-auto space-y-1">
-                                            {coachPlan.plan_json.days.slice(0,7).map((d, idx) => {
-                                                const title = d?.label || d?.task || d?.type || 'Practice';
-                                                const focus = Array.isArray(d?.focus) ? d.focus.join(', ') : (d?.focus || '');
-                                                const minutes = d?.minutes || 20;
+                                            {subjectPlanDays.slice(0,7).map((d, idx) => {
+                                                const focusList = d.tasks.flatMap((task) => Array.isArray(task.focus) ? task.focus : []);
+                                                const focus = focusList.length ? Array.from(new Set(focusList)).join(', ') : '';
+                                                const minutes = d.tasks.reduce((sum, task) => sum + (Number(task.minutes) || 0), 0) || 0;
+                                                const titles = d.tasks.map((task) => task.title).join(' • ');
                                                 return (
-                                                    <div key={idx} className="text-sm flex items-start gap-2">
+                                                    <div key={`${d.day}-${idx}`} className="text-sm flex flex-col">
                                                         <span className="font-semibold">Day {d.day}:</span>
-                                                        <span>{focus ? `${focus} — ` : ''}{title} ({minutes}m)</span>
+                                                        <span>{focus ? `${focus} — ` : ''}{titles || 'Practice'} ({minutes}m)</span>
                                                     </div>
                                                 );
                                             })}
                                         </div>
                                     ) : (
                                         <p className="text-center text-sm" style={heroMutedTextStyle}>No plan yet.</p>
                                     )}
                                     {coachError && (
                                         <p className="text-center text-xs text-red-600 mt-2">{coachError}</p>
                                     )}
                                 </div>
                                 <div className="mt-3">
                                     <button
                                         onClick={generateCoachPlan}
                                         disabled={coachLoading}
                                         className="w-full mt-2 px-4 py-2 bg-white text-slate-900 font-semibold rounded-md hover:bg-white/90 transition disabled:bg-white/70 disabled:text-slate-400"
                                     >
-                                        {coachPlan ? 'Generate / Refresh Plan' : 'Generate Plan'}
+                                        {hasPlan ? 'Generate / Refresh Plan' : 'Generate Plan'}
                                     </button>
                                 </div>
                                     </div>
                                 );
                             })()}
                             {selectedSubject === 'Reasoning Through Language Arts (RLA)' && (
                                 <div
                                     className="border-2 border-dashed rounded-lg p-4 flex flex-col justify-between hover:shadow-lg transition-all"
                                     style={{ ...panelBaseStyle, borderStyle: 'dashed' }}
                                 >
                                     <div>
                                         <div className="flex items-center justify-center gap-2" style={{ color: heroAccentColor }}>
                                             <BookOpenIcon className="h-8 w-8" />
                                             <h3 className="text-xl font-bold" style={{ color: heroTextColor }}>Essay Practice Tool</h3>
                                         </div>
                                         <p className="text-sm my-2 text-center" style={heroMutedTextStyle}>
                                             Build your extended response with guided support.
                                         </p>
                                     </div>
                                     <button
                                         onClick={() => onSelectQuiz({ id: 'essay_practice_tool', type: 'essay', title: 'GED® Essay Practice Toolkit' }, selectedSubject)}
                                         className="w-full mt-2 px-4 py-2 bg-white text-slate-900 font-semibold rounded-md hover:bg-white/90 transition"
                                     >
                                         Launch Essay Practice
                                     </button>
@@ -13947,57 +14104,57 @@ function StartScreen({ currentUser, onLogout, progress, profileBundle: profileDa
                             profilePassedMap={profilePassedMap}
                             recentSummary={recentDashboardSummary}
                         />
                     </div>
                 )}
                 {/* Coach Smith — This Week (4 subject cards) */}
                 {currentUser && (
                     <div className={`mb-6 block-profile panel coach-smith-shell coach-panel rounded-xl p-4 shadow-md ${theme === 'dark' ? '' : 'coach-gold-light'}`}>
                         <div className="flex items-center justify-between mb-3">
                             <h2 className={`text-lg font-semibold ${homePanelPrimaryTextClass}`}>Coach Smith — This Week</h2>
                             <button
                                 onClick={generateAllWeeklyPlans}
                                 disabled={generatingAll}
                                 className="text-sm font-semibold px-3 py-1 rounded-md bg-white text-slate-900 hover:bg-white/90 disabled:opacity-60 dark:bg-slate-900 dark:text-slate-100 dark:hover:bg-slate-800"
                                 title="Generate weekly plans for Math, RLA, Science, and Social Studies"
                             >{generatingAll ? 'Generating…' : 'Generate all'}</button>
                         </div>
 
                         {dailyLoading ? (
                             <p className={`text-sm ${homePanelPrimaryTextClass}`}>Loading...</p>
                         ) : dailyError ? (
                             <p className="text-sm text-red-600">{dailyError}</p>
                         ) : (
                             <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                 {["Math", "Reasoning Through Language Arts (RLA)", "Science", "Social Studies"].map((label) => {
-                                    const match = Array.isArray(weeklySubjects)
-                                        ? weeklySubjects.find((ws) => {
-                                            if (label === 'Reasoning Through Language Arts (RLA)') {
-                                                return ws.subject === 'RLA' || ws.subject === label;
-                                            }
-                                            return ws.subject === label;
-                                        })
+                                    const match = Array.isArray(weeklyCoachSummary)
+                                        ? weeklyCoachSummary.find((ws) => {
+                                                if (label === 'Reasoning Through Language Arts (RLA)') {
+                                                    return ws.subject === 'RLA' || ws.subject === label;
+                                                }
+                                                return ws.subject === label;
+                                            })
                                         : null;
 
                                     const completed = Math.max(0, match?.completed_minutes_week || 0);
                                     const target = match?.expected_minutes_week || 140;
                                     const summary = match?.summary;
 
                                     // subject key for styling hooks
                                     const subjectKey = (label === 'Math')
                                       ? 'math'
                                       : (label.startsWith('Reasoning') ? 'rla' : (label === 'Science' ? 'science' : 'social'));
 
                                     return (
                                         <div
                                             key={label}
                                             className={`coach-subject-card coach-gold-card rounded-lg border p-3 backdrop-blur-sm subject-${subjectKey}`}
                                         >
                                             <div className="flex items-center justify-between mb-2">
                                                 <p className="subject-pill text-xs font-semibold uppercase tracking-wide" style={{ borderRadius: '9999px', padding: '2px 10px' }}>
                                                     {label === 'Reasoning Through Language Arts (RLA)' ? 'RLA' : label}
                                                 </p>
                                                 <span className="minutes-pill text-[0.65rem] text-slate-700 dark:text-slate-200">
                                                     {completed} / {target} min
                                                 </span>
                                             </div>
                                             {summary ? (
