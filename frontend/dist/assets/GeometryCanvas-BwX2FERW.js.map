{"version":3,"file":"GeometryCanvas-BwX2FERW.js","sources":["../../geometry/geometryMath.js","../../geometry/geometryStore.js","../../geometry/GeometryCanvas.js"],"sourcesContent":["const DEFAULT_MAX_DECIMALS = 2;\r\n\r\nconst roundValue = (value, maxDecimals = DEFAULT_MAX_DECIMALS) => {\r\n  if (!Number.isFinite(value)) return value;\r\n  const factor = Math.pow(10, maxDecimals);\r\n  return Math.round(value * factor) / factor;\r\n};\r\n\r\nconst toRadians = degrees => (degrees * Math.PI) / 180;\r\nconst toDegrees = radians => (radians * 180) / Math.PI;\r\n\r\nconst distance = (a, b) => {\r\n  return Math.hypot(b.x - a.x, b.y - a.y);\r\n};\r\n\r\nconst midpoint = (a, b) => ({\r\n  x: (a.x + b.x) / 2,\r\n  y: (a.y + b.y) / 2,\r\n});\r\n\r\nconst polygonPerimeter = points => {\r\n  if (!points || points.length < 2) return 0;\r\n  let perim = 0;\r\n  for (let i = 0; i < points.length; i++) {\r\n    const current = points[i];\r\n    const next = points[(i + 1) % points.length];\r\n    perim += distance(current, next);\r\n  }\r\n  return perim;\r\n};\r\n\r\nconst polygonArea = points => {\r\n  if (!points || points.length < 3) return 0;\r\n  let area = 0;\r\n  for (let i = 0; i < points.length; i++) {\r\n    const current = points[i];\r\n    const next = points[(i + 1) % points.length];\r\n    area += current.x * next.y - next.x * current.y;\r\n  }\r\n  return Math.abs(area) / 2;\r\n};\r\n\r\nconst triangleArea = points => {\r\n  if (!points || points.length < 3) return 0;\r\n  return polygonArea(points.slice(0, 3));\r\n};\r\n\r\nconst circleArea = radius => Math.PI * radius * radius;\r\nconst circleCircumference = radius => 2 * Math.PI * radius;\r\n\r\nconst angle = (a, vertex, c) => {\r\n  const v1x = a.x - vertex.x;\r\n  const v1y = a.y - vertex.y;\r\n  const v2x = c.x - vertex.x;\r\n  const v2y = c.y - vertex.y;\r\n\r\n  const dot = v1x * v2x + v1y * v2y;\r\n  const mag1 = Math.hypot(v1x, v1y);\r\n  const mag2 = Math.hypot(v2x, v2y);\r\n  if (mag1 === 0 || mag2 === 0) return 0;\r\n  const cos = Math.min(1, Math.max(-1, dot / (mag1 * mag2)));\r\n  return toDegrees(Math.acos(cos));\r\n};\r\n\r\nconst formatNumber = (value, decimals = DEFAULT_MAX_DECIMALS) => {\r\n  if (!Number.isFinite(value)) return String(value);\r\n  return roundValue(value, decimals).toFixed(decimals);\r\n};\r\n\r\nconst labelForIndex = index => {\r\n  const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n  const quotient = Math.floor(index / alphabet.length);\r\n  const remainder = index % alphabet.length;\r\n  return alphabet[remainder] + (quotient > 0 ? `${quotient}` : '');\r\n};\r\n\r\nconst assignLabels = points => {\r\n  return points.map((pt, index) => ({\r\n    ...pt,\r\n    label: pt.label || labelForIndex(index),\r\n  }));\r\n};\r\n\r\nconst computeTriangleMetrics = points => {\r\n  const labelled = assignLabels(points);\r\n  const [a, b, c] = labelled;\r\n  const sideAB = distance(a, b);\r\n  const sideBC = distance(b, c);\r\n  const sideCA = distance(c, a);\r\n  return {\r\n    sides: {\r\n      [`${a.label}${b.label}`]: roundValue(sideAB),\r\n      [`${b.label}${c.label}`]: roundValue(sideBC),\r\n      [`${c.label}${a.label}`]: roundValue(sideCA),\r\n    },\r\n    angles: {\r\n      [`∠${a.label}${b.label}${c.label}`]: roundValue(angle(a, b, c)),\r\n      [`∠${b.label}${c.label}${a.label}`]: roundValue(angle(b, c, a)),\r\n      [`∠${c.label}${a.label}${b.label}`]: roundValue(angle(c, a, b)),\r\n    },\r\n    perimeter: roundValue(sideAB + sideBC + sideCA),\r\n    area: roundValue(triangleArea(labelled)),\r\n  };\r\n};\r\n\r\nconst computePolygonMetrics = points => {\r\n  const labelled = assignLabels(points);\r\n  const sides = {};\r\n  for (let i = 0; i < labelled.length; i++) {\r\n    const current = labelled[i];\r\n    const next = labelled[(i + 1) % labelled.length];\r\n    sides[`${current.label}${next.label}`] = roundValue(distance(current, next));\r\n  }\r\n  return {\r\n    sides,\r\n    perimeter: roundValue(polygonPerimeter(labelled)),\r\n    area: roundValue(polygonArea(labelled)),\r\n  };\r\n};\r\n\r\nconst computeCircleMetrics = ({ center, radius }) => {\r\n  return {\r\n    center,\r\n    radius: roundValue(radius),\r\n    diameter: roundValue(radius * 2),\r\n    circumference: roundValue(circleCircumference(radius)),\r\n    area: roundValue(circleArea(radius)),\r\n  };\r\n};\r\n\r\nconst buildAriaLabel = (shape, metrics) => {\r\n  switch (shape.shape) {\r\n    case 'point': {\r\n      const [pt] = shape.params.points;\r\n      return `Point ${pt.label || ''} at (${formatNumber(pt.x)}, ${formatNumber(pt.y)})`;\r\n    }\r\n    case 'segment':\r\n    case 'line_segment': {\r\n      const [a, b] = assignLabels(shape.params.points);\r\n      const length = metrics.length || metrics.distance;\r\n      return `Segment ${a.label}${b.label} with length ${formatNumber(length || distance(a, b))} units`;\r\n    }\r\n    case 'triangle': {\r\n      const labelled = assignLabels(shape.params.points);\r\n      const [a, b, c] = labelled;\r\n      return `Triangle ${a.label}${b.label}${c.label} with sides ${a.label}${b.label} = ${formatNumber(metrics.sides?.[`${a.label}${b.label}`] ?? distance(a, b))} units, ${b.label}${c.label} = ${formatNumber(metrics.sides?.[`${b.label}${c.label}`] ?? distance(b, c))} units, ${c.label}${a.label} = ${formatNumber(metrics.sides?.[`${c.label}${a.label}`] ?? distance(c, a))} units`;\r\n    }\r\n    case 'polygon': {\r\n      const labelled = assignLabels(shape.params.points);\r\n      const names = labelled.map(pt => pt.label).join('');\r\n      return `Polygon ${names} with perimeter ${formatNumber(metrics.perimeter)} units and area ${formatNumber(metrics.area)} square units`;\r\n    }\r\n    case 'circle': {\r\n      const label = shape.params.label || 'Circle';\r\n      return `${label} with radius ${formatNumber(metrics.radius)} units`;\r\n    }\r\n    default:\r\n      return `${shape.shape} element`;\r\n  }\r\n};\r\n\r\nconst computeShapeMetrics = shape => {\r\n  if (!shape) return null;\r\n  switch (shape.shape) {\r\n    case 'point': {\r\n      const [pt] = assignLabels(shape.params.points);\r\n      return { point: pt };\r\n    }\r\n    case 'segment':\r\n    case 'line_segment': {\r\n      const [a, b] = assignLabels(shape.params.points);\r\n      return {\r\n        length: roundValue(distance(a, b)),\r\n        points: [a, b],\r\n      };\r\n    }\r\n    case 'triangle':\r\n      return computeTriangleMetrics(shape.params.points);\r\n    case 'polygon':\r\n      return computePolygonMetrics(shape.params.points);\r\n    case 'circle':\r\n      return computeCircleMetrics(shape.params);\r\n    default:\r\n      return null;\r\n  }\r\n};\r\n\r\nexport {\r\n  DEFAULT_MAX_DECIMALS,\r\n  angle,\r\n  assignLabels,\r\n  buildAriaLabel,\r\n  circleArea,\r\n  circleCircumference,\r\n  computeCircleMetrics,\r\n  computePolygonMetrics,\r\n  computeShapeMetrics,\r\n  computeTriangleMetrics,\r\n  distance,\r\n  formatNumber,\r\n  midpoint,\r\n  polygonArea,\r\n  polygonPerimeter,\r\n  roundValue,\r\n  toDegrees,\r\n  toRadians,\r\n};\r\n","import { assignLabels } from './geometryMath.js';\r\n\r\nlet nextId = 1;\r\n\r\nconst createInitialOverlayState = () => ({\r\n  ruler: {\r\n    visible: false,\r\n    x: -50,\r\n    y: -20,\r\n    rotation: 0,\r\n    length: 100,\r\n  },\r\n  protractor: {\r\n    visible: false,\r\n    x: -40,\r\n    y: -40,\r\n    rotation: 0,\r\n  },\r\n  compass: {\r\n    visible: false,\r\n    x: 20,\r\n    y: 20,\r\n    rotation: 0,\r\n    radius: 40,\r\n  },\r\n});\r\n\r\nconst state = {\r\n  theme: 'light',\r\n  tool: 'select',\r\n  shapes: [],\r\n  selectedId: null,\r\n  aiHelpEnabled: false,\r\n  overlays: createInitialOverlayState(),\r\n  measurement: null,\r\n};\r\n\r\nconst listeners = new Set();\r\n\r\nconst cloneState = src => JSON.parse(JSON.stringify(src));\r\n\r\nconst notify = () => {\r\n  const snapshot = cloneState(state);\r\n  listeners.forEach(listener => {\r\n    try {\r\n      listener(snapshot);\r\n    } catch (err) {\r\n      console.error('geometryStore listener error', err);\r\n    }\r\n  });\r\n};\r\n\r\nconst subscribe = listener => {\r\n  listeners.add(listener);\r\n  return () => listeners.delete(listener);\r\n};\r\n\r\nconst getState = () => cloneState(state);\r\n\r\nconst normalizePoints = points => {\r\n  if (!Array.isArray(points)) return [];\r\n  return assignLabels(points).map(pt => ({\r\n    id: pt.id || `${pt.label}`,\r\n    label: pt.label,\r\n    x: pt.x,\r\n    y: pt.y,\r\n  }));\r\n};\r\n\r\nconst ensureShapeLabel = shape => {\r\n  if (shape.shape === 'circle') {\r\n    if (!shape.params.label) {\r\n      shape.params.label = `Circle ${nextId}`;\r\n    }\r\n    return shape;\r\n  }\r\n  const points = shape.params?.points || [];\r\n  const names = points.map(pt => pt.label).join('');\r\n  if (!shape.label) {\r\n    const friendly = names ? `${shape.shape.charAt(0).toUpperCase()}${shape.shape.slice(1)} ${names}` : `${shape.shape}`;\r\n    shape.label = friendly;\r\n  }\r\n  return shape;\r\n};\r\n\r\nconst addShape = (shapeJson = {}) => {\r\n  const id = shapeJson.id || `shape-${nextId++}`;\r\n  const shape = {\r\n    id,\r\n    shape: shapeJson.shape || 'point',\r\n    params: {\r\n      ...shapeJson.params,\r\n    },\r\n    style: shapeJson.style || {},\r\n  };\r\n\r\n  if (Array.isArray(shape.params?.points)) {\r\n    shape.params.points = normalizePoints(shape.params.points);\r\n  }\r\n\r\n  ensureShapeLabel(shape);\r\n\r\n  state.shapes = [...state.shapes, shape];\r\n  state.selectedId = id;\r\n  notify();\r\n  return id;\r\n};\r\n\r\nconst updateShape = (id, partial = {}) => {\r\n  const index = state.shapes.findIndex(item => item.id === id);\r\n  if (index === -1) return;\r\n  const existing = state.shapes[index];\r\n  const next = {\r\n    ...existing,\r\n    ...partial,\r\n    params: {\r\n      ...existing.params,\r\n      ...partial.params,\r\n    },\r\n    style: {\r\n      ...existing.style,\r\n      ...(partial.style || {}),\r\n    },\r\n  };\r\n  if (Array.isArray(next.params.points)) {\r\n    next.params.points = normalizePoints(next.params.points);\r\n  }\r\n  ensureShapeLabel(next);\r\n  state.shapes = [\r\n    ...state.shapes.slice(0, index),\r\n    next,\r\n    ...state.shapes.slice(index + 1),\r\n  ];\r\n  notify();\r\n};\r\n\r\nconst setSelection = idOrNull => {\r\n  state.selectedId = idOrNull;\r\n  notify();\r\n};\r\n\r\nconst setTool = toolName => {\r\n  state.tool = toolName;\r\n  state.measurement = null;\r\n  notify();\r\n};\r\n\r\nconst setTheme = themeName => {\r\n  state.theme = themeName === 'dark' ? 'dark' : 'light';\r\n  notify();\r\n};\r\n\r\nconst setAIHelpEnabled = on => {\r\n  state.aiHelpEnabled = !!on;\r\n  notify();\r\n};\r\n\r\nconst getAIHelpEnabled = () => state.aiHelpEnabled;\r\n\r\nconst reset = () => {\r\n  state.shapes = [];\r\n  state.selectedId = null;\r\n  state.tool = 'select';\r\n  state.overlays = createInitialOverlayState();\r\n  state.measurement = null;\r\n  notify();\r\n};\r\n\r\nconst setOverlayVisibility = (name, visible) => {\r\n  if (!state.overlays[name]) return;\r\n  state.overlays[name].visible = visible;\r\n  notify();\r\n};\r\n\r\nconst updateOverlay = (name, partial) => {\r\n  if (!state.overlays[name]) return;\r\n  state.overlays[name] = {\r\n    ...state.overlays[name],\r\n    ...partial,\r\n  };\r\n  notify();\r\n};\r\n\r\nconst setMeasurement = measurement => {\r\n  state.measurement = measurement;\r\n  notify();\r\n};\r\n\r\nconst getSceneJson = () => {\r\n  return {\r\n    theme: state.theme,\r\n    tool: state.tool,\r\n    shapes: cloneState(state.shapes),\r\n    overlays: cloneState(state.overlays),\r\n  };\r\n};\r\n\r\nexport {\r\n  addShape,\r\n  getAIHelpEnabled,\r\n  getSceneJson,\r\n  getState,\r\n  reset,\r\n  setAIHelpEnabled,\r\n  setMeasurement,\r\n  setOverlayVisibility,\r\n  setSelection,\r\n  setTheme,\r\n  setTool,\r\n  subscribe,\r\n  updateOverlay,\r\n  updateShape,\r\n};\r\n","import {\r\n  addShape,\r\n  getState,\r\n  setMeasurement,\r\n  setSelection,\r\n  subscribe,\r\n  updateOverlay,\r\n  updateShape,\r\n} from './geometryStore.js';\r\nimport {\r\n  DEFAULT_MAX_DECIMALS,\r\n  assignLabels,\r\n  buildAriaLabel,\r\n  computeShapeMetrics,\r\n  distance,\r\n  formatNumber,\r\n  roundValue,\r\n} from './geometryMath.js';\r\n\r\nconst SVG_NS = 'http://www.w3.org/2000/svg';\r\nconst GRID_SIZE = 10;\r\nconst MIN_ZOOM = 0.35;\r\nconst MAX_ZOOM = 4;\r\n\r\nconst THEME_VARIANTS = {\r\n  light: {\r\n    background: '#ffffff',\r\n    gridStroke: '#e5e5e5',\r\n    primaryStroke: '#1d1d1f',\r\n    primaryFill: 'rgba(33, 33, 33, 0.06)',\r\n    text: '#111111',\r\n    glow: 'drop-shadow(0 2px 6px rgba(0,0,0,0.2))',\r\n    handleFill: '#ffffff',\r\n    handleStroke: '#333333',\r\n    overlayStroke: '#2c3e50',\r\n    overlayFill: 'rgba(52, 152, 219, 0.08)',\r\n    measurementText: '#0f172a',\r\n  },\r\n  dark: {\r\n    background: '#050505',\r\n    gridStroke: 'rgba(0,255,255,0.12)',\r\n    primaryStroke: '#ffffff',\r\n    primaryFill: 'rgba(0,255,255,0.12)',\r\n    text: '#e2fdff',\r\n    glow: 'drop-shadow(0 0 8px rgba(0,255,255,0.3))',\r\n    handleFill: '#001a1d',\r\n    handleStroke: '#8af3ff',\r\n    overlayStroke: '#8af3ff',\r\n    overlayFill: 'rgba(0,255,255,0.08)',\r\n    measurementText: '#ffffff',\r\n  },\r\n};\r\n\r\nconst ensureStyleTag = () => {\r\n  if (document.getElementById('geometry-canvas-styles')) return;\r\n  const style = document.createElement('style');\r\n  style.id = 'geometry-canvas-styles';\r\n  style.textContent = `\r\n    .geometry-canvas-root {\r\n      position: relative;\r\n      width: 100%;\r\n      height: 100%;\r\n      touch-action: none;\r\n      border-radius: 12px;\r\n      overflow: hidden;\r\n    }\r\n    .geometry-canvas-svg {\r\n      width: 100%;\r\n      height: 100%;\r\n      display: block;\r\n      transition: background-color 160ms ease;\r\n    }\r\n    .geometry-shape {\r\n      transition: opacity 150ms ease, stroke 160ms ease, fill 160ms ease;\r\n      opacity: 0;\r\n      animation: geometry-shape-fade 150ms ease forwards;\r\n      filter: var(--geometry-shape-shadow, none);\r\n    }\r\n    .geometry-handle {\r\n      cursor: pointer;\r\n      transition: transform 120ms ease;\r\n    }\r\n    .geometry-handle:hover {\r\n      transform: scale(1.15);\r\n    }\r\n    .geometry-overlay {\r\n      cursor: move;\r\n      transition: opacity 150ms ease;\r\n    }\r\n    .geometry-overlay-handle {\r\n      cursor: grab;\r\n    }\r\n    .geometry-overlay-handle:active {\r\n      cursor: grabbing;\r\n    }\r\n    .geometry-measure-label {\r\n      font-size: 10px;\r\n      user-select: none;\r\n      pointer-events: none;\r\n    }\r\n    @keyframes geometry-shape-fade {\r\n      from { opacity: 0; }\r\n      to { opacity: 1; }\r\n    }\r\n  `;\r\n  document.head.appendChild(style);\r\n};\r\n\r\nclass GeometryCanvas {\r\n  constructor(container, options = {}) {\r\n    if (!container) {\r\n      throw new Error('GeometryCanvas requires a container element.');\r\n    }\r\n\r\n    ensureStyleTag();\r\n\r\n    this.container = container;\r\n    this.container.classList.add('geometry-canvas-root');\r\n\r\n    this.state = getState();\r\n    this.viewBox = { x: -200, y: -200, width: 400, height: 400 };\r\n    this.panStart = null;\r\n    this.draft = null;\r\n    this.measurePoints = [];\r\n    this.dragContext = null;\r\n    this.options = options;\r\n\r\n    this.svg = document.createElementNS(SVG_NS, 'svg');\r\n    this.svg.setAttribute('class', 'geometry-canvas-svg');\r\n    this.svg.setAttribute('role', 'application');\r\n    this.svg.setAttribute('aria-label', 'Interactive geometry canvas');\r\n    this.svg.setAttribute('viewBox', `${this.viewBox.x} ${this.viewBox.y} ${this.viewBox.width} ${this.viewBox.height}`);\r\n\r\n    this.defs = document.createElementNS(SVG_NS, 'defs');\r\n    this.gridPattern = document.createElementNS(SVG_NS, 'pattern');\r\n    this.gridPattern.setAttribute('id', `grid-pattern-${Math.random().toString(36).slice(2, 8)}`);\r\n    this.gridPattern.setAttribute('patternUnits', 'userSpaceOnUse');\r\n    this.gridPattern.setAttribute('width', GRID_SIZE);\r\n    this.gridPattern.setAttribute('height', GRID_SIZE);\r\n\r\n    this.gridPath = document.createElementNS(SVG_NS, 'path');\r\n    this.gridPath.setAttribute('d', `M ${GRID_SIZE} 0 L 0 0 0 ${GRID_SIZE}`);\r\n    this.gridPath.setAttribute('fill', 'none');\r\n    this.gridPath.setAttribute('stroke-width', '0.5');\r\n\r\n    this.gridPattern.appendChild(this.gridPath);\r\n    this.defs.appendChild(this.gridPattern);\r\n\r\n    this.dropShadowFilter = document.createElementNS(SVG_NS, 'filter');\r\n    this.dropShadowFilter.setAttribute('id', 'geometry-shadow');\r\n    const feDrop = document.createElementNS(SVG_NS, 'feDropShadow');\r\n    feDrop.setAttribute('dx', '0');\r\n    feDrop.setAttribute('dy', '2');\r\n    feDrop.setAttribute('stdDeviation', '2');\r\n    feDrop.setAttribute('flood-color', 'rgba(0,0,0,0.18)');\r\n    this.dropShadowFilter.appendChild(feDrop);\r\n    this.defs.appendChild(this.dropShadowFilter);\r\n\r\n    this.svg.appendChild(this.defs);\r\n\r\n    this.gridRect = document.createElementNS(SVG_NS, 'rect');\r\n    this.gridRect.setAttribute('x', '-1000');\r\n    this.gridRect.setAttribute('y', '-1000');\r\n    this.gridRect.setAttribute('width', '2000');\r\n    this.gridRect.setAttribute('height', '2000');\r\n    this.gridRect.setAttribute('fill', `url(#${this.gridPattern.getAttribute('id')})`);\r\n    this.svg.appendChild(this.gridRect);\r\n\r\n    this.overlayGroup = document.createElementNS(SVG_NS, 'g');\r\n    this.overlayGroup.setAttribute('class', 'geometry-overlays');\r\n    this.svg.appendChild(this.overlayGroup);\r\n\r\n    this.shapeGroup = document.createElementNS(SVG_NS, 'g');\r\n    this.shapeGroup.setAttribute('class', 'geometry-shapes');\r\n    this.svg.appendChild(this.shapeGroup);\r\n\r\n    this.measureGroup = document.createElementNS(SVG_NS, 'g');\r\n    this.measureGroup.setAttribute('class', 'geometry-measurements');\r\n    this.svg.appendChild(this.measureGroup);\r\n\r\n    this.handleGroup = document.createElementNS(SVG_NS, 'g');\r\n    this.handleGroup.setAttribute('class', 'geometry-handles');\r\n    this.svg.appendChild(this.handleGroup);\r\n\r\n    container.appendChild(this.svg);\r\n\r\n    this.shapeElements = new Map();\r\n    this.overlayElements = new Map();\r\n\r\n    this.svg.addEventListener('pointerdown', this.onPointerDown.bind(this));\r\n    this.svg.addEventListener('pointermove', this.onPointerMove.bind(this));\r\n    this.svg.addEventListener('pointerup', this.onPointerUp.bind(this));\r\n    this.svg.addEventListener('pointerleave', this.onPointerUp.bind(this));\r\n    this.svg.addEventListener('wheel', this.onWheel.bind(this), { passive: false });\r\n    this.svg.addEventListener('dblclick', this.onDoubleClick.bind(this));\r\n\r\n    this.unsubscribe = subscribe(snapshot => {\r\n      const previousTool = this.state?.tool;\r\n      this.state = snapshot;\r\n      if (previousTool === 'measure' && snapshot.tool !== 'measure') {\r\n        this.measurePoints = [];\r\n      }\r\n      this.render();\r\n    });\r\n\r\n    this.render();\r\n  }\r\n\r\n  destroy() {\r\n    this.unsubscribe?.();\r\n    this.svg.remove();\r\n  }\r\n\r\n  get theme() {\r\n    return THEME_VARIANTS[this.state.theme] || THEME_VARIANTS.light;\r\n  }\r\n\r\n  setViewBox(viewBox) {\r\n    this.viewBox = viewBox;\r\n    this.svg.setAttribute('viewBox', `${viewBox.x} ${viewBox.y} ${viewBox.width} ${viewBox.height}`);\r\n    this.updateGridPattern();\r\n  }\r\n\r\n  updateGridPattern() {\r\n    const { gridStroke } = this.theme;\r\n    this.gridPath.setAttribute('stroke', gridStroke);\r\n    const scale = this.viewBox.width / this.svg.clientWidth || 1;\r\n    this.gridPath.setAttribute('stroke-width', `${0.5 * Math.max(scale, 0.5)}`);\r\n    this.gridPattern.setAttribute('patternTransform', `translate(${this.viewBox.x} ${this.viewBox.y})`);\r\n  }\r\n\r\n  toWorldPoint(evt) {\r\n    const rect = this.svg.getBoundingClientRect();\r\n    const xRatio = (evt.clientX - rect.left) / rect.width;\r\n    const yRatio = (evt.clientY - rect.top) / rect.height;\r\n    const x = this.viewBox.x + xRatio * this.viewBox.width;\r\n    const y = this.viewBox.y + yRatio * this.viewBox.height;\r\n    return { x, y };\r\n  }\r\n\r\n  snapPoint(point) {\r\n    const snap = value => Math.round(value / GRID_SIZE) * GRID_SIZE;\r\n    return {\r\n      x: snap(point.x),\r\n      y: snap(point.y),\r\n    };\r\n  }\r\n\r\n  onPointerDown(evt) {\r\n    const tool = this.state.tool;\r\n    const rawPoint = this.toWorldPoint(evt);\r\n    const point = this.snapPoint(rawPoint);\r\n    const target = evt.target;\r\n    evt.preventDefault();\r\n\r\n    const overlayHandle = target.dataset.overlayHandle;\r\n    if (overlayHandle) {\r\n      const overlayName = target.dataset.overlayName;\r\n      const overlayState = this.state.overlays[overlayName];\r\n      if (!overlayState) return;\r\n      if (overlayHandle === 'rotate') {\r\n        this.dragContext = {\r\n          type: 'overlay-rotate',\r\n          overlay: overlayName,\r\n          origin: { x: overlayState.x, y: overlayState.y },\r\n        };\r\n      } else if (overlayHandle === 'resize') {\r\n        this.dragContext = {\r\n          type: 'overlay-resize',\r\n          overlay: overlayName,\r\n          origin: { x: overlayState.x, y: overlayState.y },\r\n        };\r\n      } else {\r\n        this.dragContext = {\r\n          type: 'overlay',\r\n          overlay: overlayName,\r\n          offset: { x: rawPoint.x - overlayState.x, y: rawPoint.y - overlayState.y },\r\n        };\r\n      }\r\n      return;\r\n    }\r\n\r\n    const vertexHandle = target.dataset.vertexIndex;\r\n    if (vertexHandle) {\r\n      const shapeId = target.dataset.shapeId;\r\n      if (vertexHandle === 'radius') {\r\n        const circleParams = this.getCircleParams(shapeId);\r\n        this.dragContext = {\r\n          type: 'circle-radius',\r\n          shapeId,\r\n          center: circleParams?.center,\r\n        };\r\n        setSelection(shapeId);\r\n        return;\r\n      }\r\n      if (vertexHandle === 'center') {\r\n        const circleParams = this.getCircleParams(shapeId);\r\n        this.dragContext = {\r\n          type: 'circle-center',\r\n          shapeId,\r\n          circle: circleParams,\r\n        };\r\n        setSelection(shapeId);\r\n        return;\r\n      }\r\n      this.dragContext = {\r\n        type: 'vertex',\r\n        shapeId,\r\n        index: Number(vertexHandle),\r\n      };\r\n      setSelection(shapeId);\r\n      return;\r\n    }\r\n\r\n    const shapeId = target.closest?.('[data-shape-id]')?.dataset?.shapeId;\r\n    if (shapeId && tool === 'select') {\r\n      setSelection(shapeId);\r\n        this.dragContext = {\r\n          type: 'shape',\r\n          shapeId,\r\n          startPoint: point,\r\n          rawStart: rawPoint,\r\n          originalPoints: this.getShapePoints(shapeId),\r\n          originalCircle: this.getCircleParams(shapeId),\r\n        };\r\n      return;\r\n    }\r\n\r\n    if (tool === 'select') {\r\n      this.dragContext = {\r\n        type: 'pan',\r\n        start: { x: evt.clientX, y: evt.clientY },\r\n        viewBox: { ...this.viewBox },\r\n      };\r\n      setSelection(null);\r\n      return;\r\n    }\r\n\r\n    if (tool === 'measure') {\r\n      this.handleMeasurePoint(point);\r\n      return;\r\n    }\r\n\r\n    this.handleDrawingPoint(point);\r\n  }\r\n\r\n  onPointerMove(evt) {\r\n    if (!this.dragContext && !this.draft) return;\r\n    const rawPoint = this.toWorldPoint(evt);\r\n    const point = this.snapPoint(rawPoint);\r\n\r\n    if (this.dragContext) {\r\n      switch (this.dragContext.type) {\r\n        case 'pan': {\r\n          const { start, viewBox } = this.dragContext;\r\n          const deltaX = ((evt.clientX - start.x) / this.svg.clientWidth) * viewBox.width;\r\n          const deltaY = ((evt.clientY - start.y) / this.svg.clientHeight) * viewBox.height;\r\n          this.setViewBox({\r\n            x: viewBox.x - deltaX,\r\n            y: viewBox.y - deltaY,\r\n            width: viewBox.width,\r\n            height: viewBox.height,\r\n          });\r\n          break;\r\n        }\r\n        case 'vertex': {\r\n          updateShape(this.dragContext.shapeId, {\r\n            params: {\r\n              points: this.getShapePoints(this.dragContext.shapeId).map((pt, index) => {\r\n                if (index === this.dragContext.index) {\r\n                  return { ...pt, x: point.x, y: point.y };\r\n                }\r\n                return pt;\r\n              }),\r\n            },\r\n          });\r\n          break;\r\n        }\r\n        case 'shape': {\r\n          const { shapeId, rawStart, originalPoints, originalCircle } = this.dragContext;\r\n          const dx = rawPoint.x - rawStart.x;\r\n          const dy = rawPoint.y - rawStart.y;\r\n          if (originalPoints) {\r\n            updateShape(shapeId, {\r\n              params: {\r\n                points: originalPoints.map(pt => ({\r\n                  ...pt,\r\n                  x: pt.x + dx,\r\n                  y: pt.y + dy,\r\n                })),\r\n              },\r\n            });\r\n          } else if (originalCircle) {\r\n            updateShape(shapeId, {\r\n              params: {\r\n                center: {\r\n                  x: originalCircle.center.x + dx,\r\n                  y: originalCircle.center.y + dy,\r\n                },\r\n                radius: originalCircle.radius,\r\n              },\r\n            });\r\n          }\r\n          break;\r\n        }\r\n        case 'circle-radius': {\r\n          const { shapeId, center } = this.dragContext;\r\n          if (!center) break;\r\n          const radius = distance(center, rawPoint);\r\n          updateShape(shapeId, {\r\n            params: {\r\n              center,\r\n              radius,\r\n            },\r\n          });\r\n          break;\r\n        }\r\n        case 'circle-center': {\r\n          const { shapeId, circle } = this.dragContext;\r\n          if (!circle) break;\r\n          updateShape(shapeId, {\r\n            params: {\r\n              center: {\r\n                x: rawPoint.x,\r\n                y: rawPoint.y,\r\n              },\r\n              radius: circle.radius,\r\n            },\r\n          });\r\n          break;\r\n        }\r\n        case 'overlay': {\r\n          updateOverlay(this.dragContext.overlay, {\r\n            x: rawPoint.x - this.dragContext.offset.x,\r\n            y: rawPoint.y - this.dragContext.offset.y,\r\n          });\r\n          break;\r\n        }\r\n        case 'overlay-rotate': {\r\n          const { origin, overlay } = this.dragContext;\r\n          const angle = Math.atan2(rawPoint.y - origin.y, rawPoint.x - origin.x);\r\n          updateOverlay(overlay, {\r\n            rotation: angle,\r\n          });\r\n          break;\r\n        }\r\n        case 'overlay-resize': {\r\n          const { origin, overlay } = this.dragContext;\r\n          const length = distance(origin, rawPoint);\r\n          if (overlay === 'ruler') {\r\n            updateOverlay(overlay, {\r\n              length,\r\n            });\r\n          } else if (overlay === 'compass') {\r\n            updateOverlay(overlay, {\r\n              radius: length,\r\n            });\r\n          }\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    if (this.draft) {\r\n      this.updateDraft(point);\r\n    }\r\n  }\r\n\r\n  onPointerUp() {\r\n    if (this.dragContext?.type === 'overlay') {\r\n      this.dragContext = null;\r\n      return;\r\n    }\r\n    this.dragContext = null;\r\n  }\r\n\r\n  onWheel(evt) {\r\n    if (!evt.ctrlKey) return;\r\n    evt.preventDefault();\r\n    const delta = evt.deltaY;\r\n    const scaleFactor = delta > 0 ? 1.1 : 0.9;\r\n    const newWidth = Math.min(Math.max(this.viewBox.width * scaleFactor, 200 * MIN_ZOOM), 2000 * MAX_ZOOM);\r\n    const newHeight = (newWidth / this.viewBox.width) * this.viewBox.height;\r\n\r\n    const cursor = this.toWorldPoint(evt);\r\n    const dx = cursor.x - this.viewBox.x;\r\n    const dy = cursor.y - this.viewBox.y;\r\n\r\n    const ratioX = dx / this.viewBox.width;\r\n    const ratioY = dy / this.viewBox.height;\r\n\r\n    const newViewBox = {\r\n      width: newWidth,\r\n      height: newHeight,\r\n      x: cursor.x - ratioX * newWidth,\r\n      y: cursor.y - ratioY * newHeight,\r\n    };\r\n    this.setViewBox(newViewBox);\r\n  }\r\n\r\n  onDoubleClick(evt) {\r\n    if (this.state.tool === 'polygon' && this.draft?.points?.length >= 3) {\r\n      evt.preventDefault();\r\n      this.finalizeDraft();\r\n    }\r\n  }\r\n\r\n  handleDrawingPoint(point) {\r\n    const tool = this.state.tool;\r\n    const shapeTypeMap = {\r\n      point: 'point',\r\n      segment: 'segment',\r\n      line: 'segment',\r\n      triangle: 'triangle',\r\n      circle: 'circle',\r\n      polygon: 'polygon',\r\n    };\r\n\r\n    const shape = shapeTypeMap[tool];\r\n    if (!shape) return;\r\n\r\n    if (shape === 'point') {\r\n      addShape({\r\n        shape: 'point',\r\n        params: {\r\n          points: [\r\n            {\r\n              x: point.x,\r\n              y: point.y,\r\n              label: 'A',\r\n            },\r\n          ],\r\n        },\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!this.draft) {\r\n      this.draft = {\r\n        shape,\r\n        points: [point],\r\n      };\r\n      this.renderDraft();\r\n      return;\r\n    }\r\n\r\n    this.draft.points.push(point);\r\n    if ((shape === 'segment' && this.draft.points.length === 2) ||\r\n      (shape === 'triangle' && this.draft.points.length === 3) ||\r\n      (shape === 'circle' && this.draft.points.length === 2)) {\r\n      this.finalizeDraft();\r\n    } else {\r\n      this.renderDraft();\r\n    }\r\n  }\r\n\r\n  handleMeasurePoint(point) {\r\n    this.measurePoints.push(point);\r\n    if (this.measurePoints.length === 2) {\r\n      const [a, b] = this.measurePoints;\r\n      const length = roundValue(distance(a, b), DEFAULT_MAX_DECIMALS);\r\n      setMeasurement({\r\n        type: 'distance',\r\n        label: `Distance ≈ ${formatNumber(length)}`,\r\n        value: length,\r\n        points: [a, b],\r\n      });\r\n    }\r\n    if (this.measurePoints.length === 3) {\r\n      const [a, b, c] = this.measurePoints;\r\n      const ab = distance(a, b);\r\n      const cb = distance(c, b);\r\n      if (ab > 0 && cb > 0) {\r\n        const angleRadians = Math.atan2(a.y - b.y, a.x - b.x) - Math.atan2(c.y - b.y, c.x - b.x);\r\n        let degrees = (angleRadians * 180) / Math.PI;\r\n        degrees = Math.abs(((degrees + 540) % 360) - 180);\r\n        const rounded = roundValue(degrees, DEFAULT_MAX_DECIMALS);\r\n        setMeasurement({\r\n          type: 'angle',\r\n          label: `Angle ≈ ${formatNumber(rounded)}°`,\r\n          value: rounded,\r\n          points: [a, b, c],\r\n        });\r\n      }\r\n      this.measurePoints = [];\r\n    }\r\n    this.renderMeasurementOverlay();\r\n  }\r\n\r\n  updateDraft(point) {\r\n    if (!this.draft) return;\r\n    const { shape, points } = this.draft;\r\n    if (shape === 'circle') {\r\n      if (points.length === 1) {\r\n        this.draft.preview = {\r\n          center: points[0],\r\n          radius: distance(points[0], point),\r\n        };\r\n      } else {\r\n        this.draft.points[this.draft.points.length - 1] = point;\r\n      }\r\n    } else {\r\n      this.draft.points[this.draft.points.length - 1] = point;\r\n    }\r\n    this.renderDraft();\r\n  }\r\n\r\n  finalizeDraft() {\r\n    if (!this.draft) return;\r\n    const { shape, points } = this.draft;\r\n    if (shape === 'circle') {\r\n      if (points.length < 2) {\r\n        this.draft = null;\r\n        return;\r\n      }\r\n      const [center, edge] = points;\r\n      const radius = distance(center, edge);\r\n      addShape({\r\n        shape: 'circle',\r\n        params: {\r\n          center,\r\n          radius,\r\n          label: 'Circle',\r\n        },\r\n      });\r\n    } else {\r\n      if (shape === 'polygon' && points.length < 3) {\r\n        this.draft = null;\r\n        this.renderDraft();\r\n        return;\r\n      }\r\n      const labelled = assignLabels(points);\r\n      const normalizedPoints = labelled.map(pt => ({\r\n        ...pt,\r\n      }));\r\n      addShape({\r\n        shape,\r\n        params: {\r\n          points: normalizedPoints,\r\n        },\r\n      });\r\n    }\r\n    this.draft = null;\r\n    this.renderDraft();\r\n  }\r\n\r\n  getShapePoints(shapeId) {\r\n    const shape = this.state.shapes.find(item => item.id === shapeId);\r\n    if (!shape) return null;\r\n    return shape.params?.points?.map(pt => ({ ...pt })) || null;\r\n  }\r\n\r\n  getCircleParams(shapeId) {\r\n    const shape = this.state.shapes.find(item => item.id === shapeId);\r\n    if (shape?.shape !== 'circle') return null;\r\n    return {\r\n      center: { ...shape.params.center },\r\n      radius: shape.params.radius,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { background, primaryStroke } = this.theme;\r\n    this.svg.style.background = background;\r\n    this.container.style.background = background;\r\n    this.svg.style.color = primaryStroke;\r\n    this.svg.style.setProperty('--geometry-shape-shadow', this.theme.glow);\r\n    this.updateGridPattern();\r\n    this.renderShapes();\r\n    this.renderHandles();\r\n    this.renderOverlays();\r\n    this.renderMeasurementOverlay();\r\n  }\r\n\r\n  renderShapes() {\r\n    const existingIds = new Set(this.state.shapes.map(shape => shape.id));\r\n    for (const [id, group] of this.shapeElements.entries()) {\r\n      if (!existingIds.has(id)) {\r\n        group.remove();\r\n        this.shapeElements.delete(id);\r\n      }\r\n    }\r\n\r\n    this.state.shapes.forEach(shape => {\r\n      const metrics = computeShapeMetrics(shape) || {};\r\n      const ariaLabel = buildAriaLabel(shape, metrics);\r\n      let group = this.shapeElements.get(shape.id);\r\n      if (!group) {\r\n        group = document.createElementNS(SVG_NS, 'g');\r\n        group.dataset.shapeId = shape.id;\r\n        group.setAttribute('class', 'geometry-shape');\r\n        this.shapeGroup.appendChild(group);\r\n        this.shapeElements.set(shape.id, group);\r\n      }\r\n      group.setAttribute('aria-label', ariaLabel);\r\n      group.replaceChildren(...this.createShapeElements(shape));\r\n      if (this.state.selectedId === shape.id) {\r\n        group.classList.add('selected');\r\n      } else {\r\n        group.classList.remove('selected');\r\n      }\r\n    });\r\n  }\r\n\r\n  createShapeElements(shape) {\r\n    const { primaryStroke, primaryFill, text } = this.theme;\r\n    const elements = [];\r\n    if (shape.shape === 'point') {\r\n      const [pt] = shape.params.points;\r\n      const circle = document.createElementNS(SVG_NS, 'circle');\r\n      circle.setAttribute('cx', pt.x);\r\n      circle.setAttribute('cy', pt.y);\r\n      circle.setAttribute('r', 3.5);\r\n      circle.setAttribute('fill', primaryStroke);\r\n      elements.push(circle);\r\n    } else if (shape.shape === 'segment') {\r\n      const [a, b] = shape.params.points;\r\n      const line = document.createElementNS(SVG_NS, 'line');\r\n      line.setAttribute('x1', a.x);\r\n      line.setAttribute('y1', a.y);\r\n      line.setAttribute('x2', b.x);\r\n      line.setAttribute('y2', b.y);\r\n      line.setAttribute('stroke', primaryStroke);\r\n      line.setAttribute('stroke-width', '2');\r\n      line.setAttribute('stroke-linecap', 'round');\r\n      elements.push(line);\r\n    } else if (shape.shape === 'triangle' || shape.shape === 'polygon') {\r\n      const polygon = document.createElementNS(SVG_NS, 'polygon');\r\n      const pointString = shape.params.points.map(pt => `${pt.x},${pt.y}`).join(' ');\r\n      polygon.setAttribute('points', pointString);\r\n      polygon.setAttribute('stroke', primaryStroke);\r\n      polygon.setAttribute('fill', primaryFill);\r\n      polygon.setAttribute('stroke-width', '2');\r\n      polygon.setAttribute('stroke-linejoin', 'round');\r\n      elements.push(polygon);\r\n    } else if (shape.shape === 'circle') {\r\n      const { center, radius } = shape.params;\r\n      const circle = document.createElementNS(SVG_NS, 'circle');\r\n      circle.setAttribute('cx', center.x);\r\n      circle.setAttribute('cy', center.y);\r\n      circle.setAttribute('r', radius);\r\n      circle.setAttribute('stroke', primaryStroke);\r\n      circle.setAttribute('fill', primaryFill);\r\n      circle.setAttribute('stroke-width', '2');\r\n      elements.push(circle);\r\n    }\r\n\r\n    if (shape.params?.points) {\r\n      shape.params.points.forEach(pt => {\r\n        const textEl = document.createElementNS(SVG_NS, 'text');\r\n      textEl.setAttribute('x', pt.x + 4);\r\n      textEl.setAttribute('y', pt.y - 6);\r\n      textEl.setAttribute('fill', text);\r\n      textEl.setAttribute('font-size', '10');\r\n      textEl.setAttribute('pointer-events', 'none');\r\n      textEl.textContent = pt.label;\r\n      elements.push(textEl);\r\n    });\r\n    }\r\n\r\n    return elements;\r\n  }\r\n\r\n  renderHandles() {\r\n    this.handleGroup.replaceChildren();\r\n    const { handleFill, handleStroke } = this.theme;\r\n    const selected = this.state.shapes.find(shape => shape.id === this.state.selectedId);\r\n    if (!selected) return;\r\n\r\n    if (selected.params?.points) {\r\n      selected.params.points.forEach((pt, index) => {\r\n        const handle = document.createElementNS(SVG_NS, 'circle');\r\n        handle.dataset.vertexIndex = index;\r\n        handle.dataset.shapeId = selected.id;\r\n        handle.setAttribute('class', 'geometry-handle');\r\n        handle.setAttribute('cx', pt.x);\r\n        handle.setAttribute('cy', pt.y);\r\n        handle.setAttribute('r', 5);\r\n        handle.setAttribute('fill', handleFill);\r\n        handle.setAttribute('stroke', handleStroke);\r\n        handle.setAttribute('stroke-width', '1.5');\r\n        this.handleGroup.appendChild(handle);\r\n      });\r\n    }\r\n\r\n    if (selected.shape === 'circle') {\r\n      const { center, radius } = selected.params;\r\n      const centerHandle = document.createElementNS(SVG_NS, 'circle');\r\n      centerHandle.dataset.vertexIndex = 'center';\r\n      centerHandle.dataset.shapeId = selected.id;\r\n      centerHandle.setAttribute('class', 'geometry-handle');\r\n      centerHandle.setAttribute('cx', center.x);\r\n      centerHandle.setAttribute('cy', center.y);\r\n      centerHandle.setAttribute('r', 5);\r\n      centerHandle.setAttribute('fill', handleFill);\r\n      centerHandle.setAttribute('stroke', handleStroke);\r\n      centerHandle.setAttribute('stroke-width', '1.5');\r\n      this.handleGroup.appendChild(centerHandle);\r\n\r\n      const radiusHandle = document.createElementNS(SVG_NS, 'circle');\r\n      radiusHandle.dataset.vertexIndex = 'radius';\r\n      radiusHandle.dataset.shapeId = selected.id;\r\n      radiusHandle.setAttribute('class', 'geometry-handle');\r\n      radiusHandle.setAttribute('cx', center.x + radius);\r\n      radiusHandle.setAttribute('cy', center.y);\r\n      radiusHandle.setAttribute('r', 5);\r\n      radiusHandle.setAttribute('fill', handleFill);\r\n      radiusHandle.setAttribute('stroke', handleStroke);\r\n      radiusHandle.setAttribute('stroke-width', '1.5');\r\n      this.handleGroup.appendChild(radiusHandle);\r\n    }\r\n  }\r\n\r\n  renderOverlays() {\r\n    const overlays = this.state.overlays || {};\r\n    const overlayNames = Object.keys(overlays);\r\n\r\n    overlayNames.forEach(name => {\r\n      const overlay = overlays[name];\r\n      let group = this.overlayElements.get(name);\r\n      if (!overlay.visible) {\r\n        if (group) {\r\n          group.remove();\r\n          this.overlayElements.delete(name);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!group) {\r\n        group = document.createElementNS(SVG_NS, 'g');\r\n        group.dataset.overlayName = name;\r\n        group.setAttribute('class', 'geometry-overlay');\r\n        this.overlayGroup.appendChild(group);\r\n        this.overlayElements.set(name, group);\r\n      }\r\n      group.replaceChildren(...this.createOverlayElements(name, overlay));\r\n    });\r\n  }\r\n\r\n  createOverlayElements(name, overlay) {\r\n    const { overlayStroke, overlayFill, text } = this.theme;\r\n    if (name === 'ruler') {\r\n      const group = document.createElementNS(SVG_NS, 'g');\r\n      group.setAttribute('transform', `translate(${overlay.x} ${overlay.y}) rotate(${(overlay.rotation * 180) / Math.PI})`);\r\n\r\n      const body = document.createElementNS(SVG_NS, 'rect');\r\n      body.setAttribute('x', '0');\r\n      body.setAttribute('y', '-6');\r\n      body.setAttribute('width', overlay.length);\r\n      body.setAttribute('height', 12);\r\n      body.setAttribute('rx', 3);\r\n      body.setAttribute('fill', overlayFill);\r\n      body.setAttribute('stroke', overlayStroke);\r\n      body.setAttribute('stroke-width', '1.4');\r\n      body.dataset.overlayHandle = 'move';\r\n      body.dataset.overlayName = 'ruler';\r\n      group.appendChild(body);\r\n\r\n      const tickGroup = document.createElementNS(SVG_NS, 'g');\r\n      const tickSpacing = GRID_SIZE / 2;\r\n      const tickCount = Math.floor(overlay.length / tickSpacing);\r\n      for (let i = 0; i <= tickCount; i++) {\r\n        const tick = document.createElementNS(SVG_NS, 'line');\r\n        const x = i * tickSpacing;\r\n        tick.setAttribute('x1', x);\r\n        tick.setAttribute('x2', x);\r\n        tick.setAttribute('y1', i % 2 === 0 ? -6 : -3);\r\n        tick.setAttribute('y2', 6);\r\n        tick.setAttribute('stroke', overlayStroke);\r\n        tick.setAttribute('stroke-width', i % 2 === 0 ? '1.2' : '0.8');\r\n        tickGroup.appendChild(tick);\r\n      }\r\n      group.appendChild(tickGroup);\r\n\r\n      const textEl = document.createElementNS(SVG_NS, 'text');\r\n      textEl.setAttribute('x', overlay.length / 2);\r\n      textEl.setAttribute('y', -10);\r\n      textEl.setAttribute('fill', text);\r\n      textEl.setAttribute('font-size', '10');\r\n      textEl.setAttribute('text-anchor', 'middle');\r\n      textEl.textContent = `≈ ${formatNumber(overlay.length / GRID_SIZE)} units`;\r\n      group.appendChild(textEl);\r\n\r\n      const rotateHandle = document.createElementNS(SVG_NS, 'circle');\r\n      rotateHandle.setAttribute('cx', overlay.length + 8);\r\n      rotateHandle.setAttribute('cy', 0);\r\n      rotateHandle.setAttribute('r', 4);\r\n      rotateHandle.setAttribute('fill', overlayFill);\r\n      rotateHandle.setAttribute('stroke', overlayStroke);\r\n      rotateHandle.dataset.overlayHandle = 'rotate';\r\n      rotateHandle.dataset.overlayName = 'ruler';\r\n      group.appendChild(rotateHandle);\r\n\r\n      group.dataset.overlayHandle = 'move';\r\n      group.dataset.overlayName = 'ruler';\r\n      return [group];\r\n    }\r\n\r\n    if (name === 'protractor') {\r\n      const group = document.createElementNS(SVG_NS, 'g');\r\n      group.setAttribute('transform', `translate(${overlay.x} ${overlay.y}) rotate(${(overlay.rotation * 180) / Math.PI})`);\r\n\r\n      const arc = document.createElementNS(SVG_NS, 'path');\r\n      const radius = 60;\r\n      const d = `M 0 0 A ${radius} ${radius} 0 0 1 ${radius} 0`; // semicircle\r\n      arc.setAttribute('d', d);\r\n      arc.setAttribute('fill', overlayFill);\r\n      arc.setAttribute('stroke', overlayStroke);\r\n      arc.setAttribute('stroke-width', '1.4');\r\n      group.appendChild(arc);\r\n\r\n      for (let i = 0; i <= 180; i += 10) {\r\n        const tick = document.createElementNS(SVG_NS, 'line');\r\n        const inner = radius - (i % 30 === 0 ? 8 : 4);\r\n        const outer = radius;\r\n        const angleRad = (i * Math.PI) / 180;\r\n        const cos = Math.cos(angleRad);\r\n        const sin = Math.sin(angleRad);\r\n        tick.setAttribute('x1', cos * inner);\r\n        tick.setAttribute('y1', -sin * inner);\r\n        tick.setAttribute('x2', cos * outer);\r\n        tick.setAttribute('y2', -sin * outer);\r\n        tick.setAttribute('stroke', overlayStroke);\r\n        tick.setAttribute('stroke-width', i % 30 === 0 ? '1.2' : '0.6');\r\n        group.appendChild(tick);\r\n        if (i % 30 === 0) {\r\n          const textEl = document.createElementNS(SVG_NS, 'text');\r\n          textEl.setAttribute('x', cos * (inner - 6));\r\n          textEl.setAttribute('y', -sin * (inner - 6));\r\n          textEl.setAttribute('fill', text);\r\n          textEl.setAttribute('font-size', '9');\r\n          textEl.setAttribute('text-anchor', 'middle');\r\n          textEl.setAttribute('alignment-baseline', 'middle');\r\n          textEl.textContent = `${i}°`;\r\n          group.appendChild(textEl);\r\n        }\r\n      }\r\n\r\n      const rotateHandle = document.createElementNS(SVG_NS, 'circle');\r\n      rotateHandle.setAttribute('cx', radius + 10);\r\n      rotateHandle.setAttribute('cy', 0);\r\n      rotateHandle.setAttribute('r', 5);\r\n      rotateHandle.setAttribute('fill', overlayFill);\r\n      rotateHandle.setAttribute('stroke', overlayStroke);\r\n      rotateHandle.dataset.overlayHandle = 'rotate';\r\n      rotateHandle.dataset.overlayName = 'protractor';\r\n      group.appendChild(rotateHandle);\r\n\r\n      group.dataset.overlayHandle = 'move';\r\n      group.dataset.overlayName = 'protractor';\r\n      return [group];\r\n    }\r\n\r\n    if (name === 'compass') {\r\n      const group = document.createElementNS(SVG_NS, 'g');\r\n      group.setAttribute('transform', `translate(${overlay.x} ${overlay.y}) rotate(${(overlay.rotation * 180) / Math.PI})`);\r\n\r\n      const leg1 = document.createElementNS(SVG_NS, 'line');\r\n      leg1.setAttribute('x1', 0);\r\n      leg1.setAttribute('y1', 0);\r\n      leg1.setAttribute('x2', 0);\r\n      leg1.setAttribute('y2', -overlay.radius);\r\n      leg1.setAttribute('stroke', overlayStroke);\r\n      leg1.setAttribute('stroke-width', '2');\r\n      group.appendChild(leg1);\r\n\r\n      const leg2 = document.createElementNS(SVG_NS, 'line');\r\n      leg2.setAttribute('x1', 8);\r\n      leg2.setAttribute('y1', 0);\r\n      leg2.setAttribute('x2', 8);\r\n      leg2.setAttribute('y2', -overlay.radius);\r\n      leg2.setAttribute('stroke', overlayStroke);\r\n      leg2.setAttribute('stroke-width', '2');\r\n      group.appendChild(leg2);\r\n\r\n      const arc = document.createElementNS(SVG_NS, 'path');\r\n      const d = `M 0 ${-overlay.radius} A ${overlay.radius} ${overlay.radius} 0 0 0 8 ${-overlay.radius}`;\r\n      arc.setAttribute('d', d);\r\n      arc.setAttribute('stroke', overlayStroke);\r\n      arc.setAttribute('fill', 'none');\r\n      arc.setAttribute('stroke-width', '1.2');\r\n      group.appendChild(arc);\r\n\r\n      const textEl = document.createElementNS(SVG_NS, 'text');\r\n      textEl.setAttribute('x', 4);\r\n      textEl.setAttribute('y', -overlay.radius - 8);\r\n      textEl.setAttribute('fill', text);\r\n      textEl.setAttribute('font-size', '10');\r\n      textEl.setAttribute('text-anchor', 'middle');\r\n      textEl.textContent = `r ≈ ${formatNumber(overlay.radius)} units`;\r\n      group.appendChild(textEl);\r\n\r\n      const resizeHandle = document.createElementNS(SVG_NS, 'circle');\r\n      resizeHandle.setAttribute('cx', 4);\r\n      resizeHandle.setAttribute('cy', -overlay.radius);\r\n      resizeHandle.setAttribute('r', 5);\r\n      resizeHandle.setAttribute('fill', overlayFill);\r\n      resizeHandle.setAttribute('stroke', overlayStroke);\r\n      resizeHandle.dataset.overlayHandle = 'resize';\r\n      resizeHandle.dataset.overlayName = 'compass';\r\n      group.appendChild(resizeHandle);\r\n\r\n      group.dataset.overlayHandle = 'move';\r\n      group.dataset.overlayName = 'compass';\r\n      return [group];\r\n    }\r\n\r\n    return [];\r\n  }\r\n\r\n  renderMeasurementOverlay() {\r\n    this.measureGroup.replaceChildren();\r\n    const measurement = this.state.measurement;\r\n    if (!measurement) return;\r\n\r\n    const { measurementText, primaryStroke, overlayFill } = this.theme;\r\n\r\n    if (measurement.type === 'distance' && measurement.points?.length === 2) {\r\n      const [a, b] = measurement.points;\r\n      const line = document.createElementNS(SVG_NS, 'line');\r\n      line.setAttribute('x1', a.x);\r\n      line.setAttribute('y1', a.y);\r\n      line.setAttribute('x2', b.x);\r\n      line.setAttribute('y2', b.y);\r\n      line.setAttribute('stroke', primaryStroke);\r\n      line.setAttribute('stroke-width', '1.2');\r\n      line.setAttribute('stroke-dasharray', '4 2');\r\n      this.measureGroup.appendChild(line);\r\n\r\n      const textEl = document.createElementNS(SVG_NS, 'text');\r\n      textEl.setAttribute('class', 'geometry-measure-label');\r\n      textEl.setAttribute('x', (a.x + b.x) / 2);\r\n      textEl.setAttribute('y', (a.y + b.y) / 2 - 6);\r\n      textEl.setAttribute('fill', measurementText);\r\n      textEl.setAttribute('text-anchor', 'middle');\r\n      textEl.textContent = measurement.label;\r\n      this.measureGroup.appendChild(textEl);\r\n    }\r\n\r\n    if (measurement.type === 'angle' && measurement.points?.length === 3) {\r\n      const [a, b, c] = measurement.points;\r\n      const path = document.createElementNS(SVG_NS, 'path');\r\n      const radius = 20;\r\n      const startAngle = Math.atan2(a.y - b.y, a.x - b.x);\r\n      const endAngle = Math.atan2(c.y - b.y, c.x - b.x);\r\n      const largeArc = Math.abs(endAngle - startAngle) > Math.PI ? 1 : 0;\r\n      const startX = b.x + radius * Math.cos(startAngle);\r\n      const startY = b.y + radius * Math.sin(startAngle);\r\n      const endX = b.x + radius * Math.cos(endAngle);\r\n      const endY = b.y + radius * Math.sin(endAngle);\r\n      const d = `M ${b.x} ${b.y} L ${startX} ${startY} A ${radius} ${radius} 0 ${largeArc} 0 ${endX} ${endY} Z`;\r\n      path.setAttribute('d', d);\r\n      path.setAttribute('fill', overlayFill || 'rgba(52, 152, 219, 0.15)');\r\n      path.setAttribute('stroke', primaryStroke);\r\n      path.setAttribute('stroke-width', '1');\r\n      this.measureGroup.appendChild(path);\r\n\r\n      const textEl = document.createElementNS(SVG_NS, 'text');\r\n      textEl.setAttribute('class', 'geometry-measure-label');\r\n      textEl.setAttribute('x', b.x + radius + 6);\r\n      textEl.setAttribute('y', b.y - radius - 6);\r\n      textEl.setAttribute('fill', measurementText);\r\n      textEl.textContent = `${measurement.label}`;\r\n      this.measureGroup.appendChild(textEl);\r\n    }\r\n  }\r\n\r\n  renderDraft() {\r\n    if (this.draftGroup) {\r\n      this.draftGroup.remove();\r\n      this.draftGroup = null;\r\n    }\r\n    if (!this.draft) return;\r\n    const { shape, points, preview } = this.draft;\r\n    const { primaryStroke, primaryFill } = this.theme;\r\n    const group = document.createElementNS(SVG_NS, 'g');\r\n    group.setAttribute('class', 'geometry-shape');\r\n\r\n    if (shape === 'segment' && points.length >= 2) {\r\n      const [a, b] = points;\r\n      const line = document.createElementNS(SVG_NS, 'line');\r\n      line.setAttribute('x1', a.x);\r\n      line.setAttribute('y1', a.y);\r\n      line.setAttribute('x2', b.x);\r\n      line.setAttribute('y2', b.y);\r\n      line.setAttribute('stroke', primaryStroke);\r\n      line.setAttribute('stroke-width', '1.4');\r\n      line.setAttribute('stroke-dasharray', '4 3');\r\n      group.appendChild(line);\r\n    }\r\n\r\n    if ((shape === 'triangle' || shape === 'polygon') && points.length >= 2) {\r\n      const polyline = document.createElementNS(SVG_NS, 'polyline');\r\n      const pointString = points.map(pt => `${pt.x},${pt.y}`).join(' ');\r\n      polyline.setAttribute('points', pointString);\r\n      polyline.setAttribute('stroke', primaryStroke);\r\n      polyline.setAttribute('fill', 'none');\r\n      polyline.setAttribute('stroke-width', '1.4');\r\n      polyline.setAttribute('stroke-dasharray', '4 2');\r\n      group.appendChild(polyline);\r\n    }\r\n\r\n    if (shape === 'circle' && preview) {\r\n      const circle = document.createElementNS(SVG_NS, 'circle');\r\n      circle.setAttribute('cx', preview.center.x);\r\n      circle.setAttribute('cy', preview.center.y);\r\n      circle.setAttribute('r', preview.radius);\r\n      circle.setAttribute('stroke', primaryStroke);\r\n      circle.setAttribute('fill', primaryFill);\r\n      circle.setAttribute('stroke-width', '1.2');\r\n      circle.setAttribute('opacity', '0.4');\r\n      group.appendChild(circle);\r\n    }\r\n\r\n    this.draftGroup = group;\r\n    this.svg.appendChild(group);\r\n  }\r\n}\r\n\r\nexport default GeometryCanvas;\r\n"],"names":["shapeId","angle"],"mappings":"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"}