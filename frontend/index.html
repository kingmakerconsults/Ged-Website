<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. Smith's Learning Canvas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .quiz-nav::-webkit-scrollbar { height: 4px; }
        .quiz-nav::-webkit-scrollbar-track { background: #f1f1f1; }
        .quiz-nav::-webkit-scrollbar-thumb { background: #888; border-radius: 2px; }
        .quiz-nav::-webkit-scrollbar-thumb:hover { background: #555; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .prose ::selection { background-color: #fef9c3; }
        .prose { max-width: 65ch; margin: auto; }
        .prose p { margin-bottom: 1em; }
        #pong-canvas { background-color: #1a202c; border-radius: 0.5rem; border: 2px solid #4a5568; }
        .option.correct { background-color: #dcfce7; border-color: #22c55e; }
        .option.incorrect { background-color: #fee2e2; border-color: #ef4444; position: relative; }
    </style>
</head>
<body class="bg-slate-100">
    <div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useRef, useCallback } = React;

// --- DATA SOURCE ---
const AppData = {
    "Social Studies": {
        "U.S. History": {
            icon: "AcademicCapIcon",
            description: "Explore the foundational events, key figures, and transformative eras of United States history.",
            topics: [
                {
                    id: "ss_us_history_foundations",
                    title: "Foundations (1491-1763)",
                    description: "Exploration, Colonial Regions, Mercantilism, French & Indian War.",
                    questions: [
                        { questionNumber: 1, type: 'text', passage: "The period from the early 15th century to the early 17th century is known as the Age of Exploration. During this time, European nations began exploring the world by sea in search of new trading routes, wealth, and knowledge. The motivations for these explorations can be summed up by the phrase 'God, Gold, and Glory.' 'Gold' refers to the desire to extract natural resources (like gold and silver) and develop new trade routes for valuable spices. 'God' refers to the mission to spread Christianity. 'Glory' refers to the competition between European monarchies to build vast empires and gain prestige.", question: "Which of the following best exemplifies the motivation of 'Gold' during the Age of Exploration?", answerOptions: [ { text: "Building missions to convert indigenous populations to Christianity.", rationale: "This is a clear example of the 'God' motivation.", isCorrect: false }, { text: "Vasco da Gama establishing a direct sea route to India to trade for spices.", rationale: "Correct. Establishing a new, direct trade route to access valuable goods like spices was a primary economic motivation ('Gold').", isCorrect: true }, { text: "Hernán Cortés conquering the Aztec Empire for the Spanish Crown.", rationale: "While this brought immense wealth, the act of conquering a vast empire for a monarch is a prime example of seeking 'Glory'.", isCorrect: false }, { text: "The creation of detailed maps of the newly discovered lands.", rationale: "This was a result of exploration and a tool for it, not the primary motivation itself.", isCorrect: false } ] },
                        { questionNumber: 2, type: 'text', passage: "Several technological advancements were crucial for the Age of Exploration. The caravel, a new type of ship, was lighter, faster, and could sail against the wind, making long ocean voyages possible. Navigation became more precise with tools like the astrolabe and the magnetic compass. The astrolabe allowed sailors to determine their latitude by measuring the angle of the sun or stars, while the compass provided a reliable sense of direction.", question: "According to the passage, how did the astrolabe aid sailors?", answerOptions: [ { text: "It helped them determine their longitude.", rationale: "The passage states it helped determine latitude. Longitude remained a difficult problem for centuries.", isCorrect: false }, { text: "It allowed them to find their precise location by measuring the angle of celestial bodies.", rationale: "Correct. The passage states it allowed sailors to determine their latitude by measuring the angle of the sun or stars.", isCorrect: true }, { text: "It provided a constant sense of direction, regardless of weather.", rationale: "This describes the function of the magnetic compass, not the astrolabe.", isCorrect: false }, { text: "It increased the speed of the ship by helping to catch the wind.", rationale: "This describes a feature of the caravel, not the astrolabe.", isCorrect: false } ] },
                        { questionNumber: 3, type: 'image', imageUrl: 'https://cdn.britannica.com/56/89956-050-B5608A65.jpg', question: "This map shows the four voyages of Christopher Columbus. Which statement is best supported by the information on the map?", answerOptions: [ { text: "All four of Columbus's voyages landed on the mainland of North America.", rationale: "The map shows his voyages were concentrated in the islands of the Caribbean, with some contact in Central and South America, but not mainland North America (modern USA/Canada).", isCorrect: false }, { text: "Columbus's final voyage was the most extensive, exploring the coast of South America.", rationale: "The map shows the fourth voyage (1502-1504, yellow line) extensively explored the coast of Central America, while the third voyage (1498, green line) was the one that reached the coast of South America.", isCorrect: false }, { text: "The voyages consistently departed from and returned to the same region in Europe.", rationale: "Correct. All four voyages are shown originating from the Iberian Peninsula (Spain/Portugal) and returning to that same area.", isCorrect: true }, { text: "Columbus successfully found a westward sea route to India on his first voyage.", rationale: "The map shows he landed in the Americas, not India. This was his famous mistake.", isCorrect: false } ] },
                        { questionNumber: 4, type: 'text', passage: "The Columbian Exchange refers to the immense transfer of plants, animals, diseases, and people between the Old World (Europe, Asia, Africa) and the New World (the Americas) following Columbus's voyages. From the New World, Europe gained transformative crops like potatoes and maize (corn), which led to a population boom. From the Old World, the Americas received animals like horses and cattle, but also devastating diseases like smallpox, which decimated indigenous populations.", question: "Which of the following was a consequence of the Columbian Exchange?", answerOptions: [ { text: "The introduction of horses to the Americas.", rationale: "Correct. The passage clearly states that animals like horses came from the Old World to the Americas.", isCorrect: true }, { text: "A decrease in the population of Europe due to new diseases from the Americas.", rationale: "The passage states the new crops led to a 'population boom' in Europe, not a decrease.", isCorrect: false }, { text: "The spread of maize and potatoes from Europe to the Americas.", rationale: "The opposite is true; maize and potatoes were sent from the Americas to Europe.", isCorrect: false }, { text: "An improvement in the health of indigenous populations.", rationale: "The passage states that Old World diseases 'decimated' indigenous populations, causing a health catastrophe.", isCorrect: false } ] },
                        { questionNumber: 5, type: 'knowledge', question: "The Treaty of Tordesillas (1494) was an agreement between which two European nations to divide the newly discovered lands outside of Europe between them?", answerOptions: [ { text: "England and France", rationale: "England and France were major rivals in colonization, but they were not parties to the Treaty of Tordesillas.", isCorrect: false }, { text: "Spain and Portugal", rationale: "Correct. The Pope brokered this treaty to divide the world's newly discovered territories between the two pioneering maritime powers, Spain and Portugal.", isCorrect: true }, { text: "The Netherlands and England", rationale: "Both were significant colonial powers, but this treaty predates much of their colonial expansion.", isCorrect: false }, { text: "France and Spain", rationale: "While both Catholic nations were major explorers, the treaty was specifically between Spain and its main rival at the time, Portugal.", isCorrect: false } ] },
                        { questionNumber: 6, type: 'text', passage: "Mercantilism was the dominant economic theory during the Age of Exploration. It held that a nation's wealth was measured by its supply of gold and silver. Colonies were seen as essential to this system, existing to provide raw materials to the mother country and to serve as a market for its manufactured goods. This created a closed economic loop designed to make the mother country rich.", question: "Under the theory of mercantilism, what was the primary purpose of colonies?", answerOptions: [ { text: "To develop into independent, self-sufficient nations.", rationale: "This is the opposite of mercantilism, which required colonies to be dependent.", isCorrect: false }, { text: "To serve as military outposts against rival empires.", rationale: "While they could serve this function, their primary purpose under mercantilism was economic.", isCorrect: false }, { text: "To enrich the mother country by providing resources and buying its goods.", rationale: "Correct. The passage clearly states colonies existed to provide raw materials and serve as a market, enriching the mother country.", isCorrect: true }, { text: "To establish free trade agreements with indigenous populations.", rationale: "Mercantilism is a system of controlled, not free, trade.", isCorrect: false } ] },
                        { questionNumber: 7, type: 'knowledge', question: "Which explorer's expedition was the first to circumnavigate the globe, proving the Earth was round?", answerOptions: [ { text: "Christopher Columbus", rationale: "Columbus's voyages landed in the Americas; he never circumnavigated the globe.", isCorrect: false }, { text: "Vasco da Gama", rationale: "Da Gama was the first to sail from Europe to India by rounding Africa's Cape of Good Hope, but his expedition did not circle the globe.", isCorrect: false }, { text: "Ferdinand Magellan", rationale: "Correct. Although Magellan himself died during the voyage, his expedition was the first to successfully sail around the world.", isCorrect: true }, { text: "Hernán Cortés", rationale: "Cortés was a conquistador known for conquering the Aztec Empire in Mexico, not for a global voyage.", isCorrect: false } ] },
                        { questionNumber: 8, type: 'text', passage: "The introduction of the horse by the Spanish had a profound impact on the cultures of the Great Plains in North America. Many indigenous groups, who had previously been pedestrian hunters, adopted the horse and became highly mobile. This shift transformed their methods of hunting bison, their social structures, and their patterns of warfare.", question: "What was a major consequence of the introduction of horses to the Americas?", answerOptions: [ { text: "It caused a decline in the bison population due to overhunting.", rationale: "While hunting became more efficient, the primary impact discussed is on the cultures of the people, not immediately on the bison population itself.", isCorrect: false }, { text: "It led many indigenous groups to abandon hunting in favor of agriculture.", rationale: "The passage states the opposite: horses made them more effective and mobile hunters.", isCorrect: false }, { text: "It led to significant cultural and lifestyle changes for many Native American groups.", rationale: "Correct. The passage describes a transformation in hunting, social structures, and warfare, which are all significant cultural changes.", isCorrect: true }, { text: "It allowed Native Americans to successfully repel European colonization.", rationale: "While horses enhanced their military capabilities, they did not ultimately prevent European colonization.", isCorrect: false } ] },
                        { questionNumber: 9, type: 'map', imageUrl: 'https://webs.bcp.org/sites/vcleary/ModernWorldHistory/Americas/jpegs/EncomiendaSystem.jpg', question: "This diagram illustrates the Encomienda system established by the Spanish in the Americas. Based on the diagram, what was the relationship between the Spanish Crown and the indigenous people?", answerOptions: [ { text: "The indigenous people paid taxes directly to the Spanish Crown in exchange for protection.", rationale: "The diagram shows the indigenous people providing labor and tribute to the Encomenderos (Spanish colonists), not directly to the Crown.", isCorrect: false }, { text: "The Spanish Crown granted colonists control over native labor in exchange for the colonists' promise to 'protect' and convert them.", rationale: "Correct. The diagram shows the Crown granting the encomienda to the colonists, who in turn were supposed to protect and Christianize the natives while extracting labor and tribute.", isCorrect: true }, { text: "The indigenous people and Spanish colonists were considered equal partners in the eyes of the Crown.", rationale: "The system is clearly hierarchical and exploitative, not a partnership of equals.", isCorrect: false }, { text: "The Spanish Crown paid the colonists to provide education and healthcare to the indigenous people.", rationale: "The flow of wealth was from the indigenous people to the colonists, not from the Crown for social services.", isCorrect: false } ] },
                        { questionNumber: 10, type: 'knowledge', question: "The part of the Triangular Trade route that transported enslaved Africans from Africa to the Americas under brutal conditions was known as the:", answerOptions: [ { text: "The Columbian Exchange", rationale: "The Columbian Exchange refers to the transfer of goods and diseases, not the specific slave route.", isCorrect: false }, { text: "The Middle Passage", rationale: "Correct. This is the specific term for the horrific sea journey endured by enslaved Africans across the Atlantic.", isCorrect: true }, { text: "The Silk Road", rationale: "The Silk Road was an ancient network of trade routes connecting the East and West over land.", isCorrect: false }, { text: "The Spice Route", rationale: "This refers to the sea routes from Europe to the East Indies for the spice trade.", isCorrect: false } ] },
                        { questionNumber: 11, type: 'text', passage: "The long-term effects of the Age of Exploration were immense. It led to the globalization of trade, the establishment of vast European colonial empires, and a massive redistribution of wealth and power. However, it also resulted in the brutal exploitation of indigenous populations in the Americas and Africa, the destruction of ancient civilizations, and the transatlantic slave trade.", question: "Which statement best summarizes the dual nature of the legacy of the Age of Exploration?", answerOptions: [ { text: "It was a period of peaceful cultural exchange between different societies.", rationale: "The passage explicitly mentions 'brutal exploitation' and 'destruction,' contradicting the idea of a peaceful exchange.", isCorrect: false }, { text: "It resulted in economic growth and globalization but also caused widespread human suffering and exploitation.", rationale: "Correct. This statement accurately captures both the positive economic outcomes (globalization, wealth) and the negative human consequences (exploitation, destruction) described in the passage.", isCorrect: true }, { text: "It was a complete failure that brought no benefits to Europe.", rationale: "The passage clearly states it led to 'unprecedented economic growth' and a 'redistribution of wealth and power' in Europe's favor.", isCorrect: false }, { text: "It primarily benefited the indigenous populations of the Americas and Africa.", rationale: "The passage argues the opposite, stating that these populations were brutally exploited.", isCorrect: false } ] },
                        { questionNumber: 12, type: 'image', imageUrl: 'https://s3.amazonaws.com/s3.timetoast.com/public/uploads/photos/10188734/aztec_smallpox.jpg', question: "This image depicts the impact of a smallpox epidemic on the Aztec population. This event is a direct result of which historical process?", answerOptions: [ { text: "The Triangular Trade", rationale: "While part of the larger system, the specific introduction of disease is best described by another term.", isCorrect: false }, { text: "The Encomienda System", rationale: "The Encomienda system was a system of labor, not the process of biological transfer.", isCorrect: false }, { text: "The Protestant Reformation", rationale: "This was a religious movement within Europe and had no direct connection to the spread of disease in the Americas.", isCorrect: false }, { text: "The Columbian Exchange", rationale: "Correct. The spread of diseases like smallpox from the Old World to the New World, which had no immunity, was one of the most devastating aspects of the Columbian Exchange.", isCorrect: true } ] },
                        { questionNumber: 13, type: 'knowledge', question: "Which European country was the early leader in the Age of Exploration, establishing trading posts along the coast of Africa and finding a sea route to India?", answerOptions: [ { text: "Spain", rationale: "Spain was a major power, but Portugal was the pioneer in exploring the African coast and reaching India by sea.", isCorrect: false }, { text: "England", rationale: "England became a major colonial power later; Portugal led the initial phase.", isCorrect: false }, { text: "France", rationale: "France's major explorations began after Portugal had already established its routes.", isCorrect: false }, { text: "Portugal", rationale: "Correct. Spearheaded by figures like Prince Henry the Navigator and Vasco da Gama, Portugal was the leading nation in the early stages of exploration.", isCorrect: true } ] },
                        { questionNumber: 14, type: 'text', passage: "The conquest of the Aztec and Inca empires by small Spanish forces was aided by several factors. The Spanish had superior military technology, including steel weapons, armor, and firearms. They also benefited from alliances with local groups who were enemies of the dominant empires. However, the most significant factor was disease. Epidemics of smallpox and other European illnesses, to which the native populations had no immunity, swept through the empires, killing a vast percentage of their people and creating social chaos.", question: "According to the passage, what was the most important factor in the Spanish conquest of the Aztecs and Incas?", answerOptions: [ { text: "The superior numbers of the Spanish armies.", rationale: "The passage states the conquests were achieved by 'small Spanish forces.'", isCorrect: false }, { text: "The devastating impact of European diseases.", rationale: "Correct. The passage explicitly identifies disease as 'the most significant factor.'", isCorrect: true }, { text: "The failure of the Aztecs and Incas to use alliances.", rationale: "The passage notes that the Spanish, not the empires, successfully used alliances to their advantage.", isCorrect: false }, { text: "The advanced naval power of the Spanish fleet.", rationale: "Naval power was crucial for reaching the Americas, but the conquest itself depended on land-based factors.", isCorrect: false } ] },
                        { questionNumber: 15, type: 'knowledge', question: "What valuable spice from the East Indies was a primary driver of European exploration and trade?", answerOptions: [ { text: "Salt", rationale: "Salt was a valuable commodity but was widely available in Europe and was not the primary driver of exploration to the East.", isCorrect: false }, { text: "Sugar", rationale: "Sugar was a valuable crop grown in the Americas, but it was not the spice that motivated the search for new routes to the East.", isCorrect: false }, { text: "Pepper", rationale: "Correct. Pepper, along with cloves and nutmeg, was extremely valuable in Europe for preserving and flavoring food, making the search for a direct trade route a top priority.", isCorrect: true }, { text: "Tobacco", rationale: "Tobacco was a New World crop introduced to Europe after the voyages of Columbus.", isCorrect: false } ] }
                    ]
                },
                {
                    id: "ss_us_history_revolution",
                    title: "The American Revolution (1763-1783)",
                    description: "Causes (Stamp Act, Intolerable Acts), Declaration of Independence, Key Battles, Treaty of Paris.",
                    questions: [
                        { questionNumber: 1, type: 'text', passage: "After the French and Indian War (1754-1763), Great Britain was left with a significant war debt. To manage this debt, the British Parliament began imposing new taxes on the American colonies. Acts like the Stamp Act (1765) and the Townshend Acts (1767) taxed goods such as paper, glass, and tea. Colonists strongly protested these taxes, arguing that they were a form of 'taxation without representation,' since the colonies had no elected representatives in the British Parliament to voice their interests.", question: "What was the primary argument used by American colonists to protest the taxes imposed by the British Parliament after 1763?", answerOptions: [ { text: "The taxes were economically ruinous and would destroy colonial businesses.", rationale: "While the economic burden was a concern, the core *political* argument was about the lack of representation, not just the economic impact.", isCorrect: false }, { text: "The taxes violated their rights as British citizens because they were not represented in Parliament.", rationale: "Correct. The slogan 'taxation without representation' captures the central grievance: that Parliament had no authority to tax them without their consent, which could only be given through their own elected representatives.", isCorrect: true }, { text: "The taxes were intended to punish the colonies for their role in the French and Indian War.", rationale: "The passage states the taxes were to manage war debt, not as a punishment for the war itself.", isCorrect: false }, { text: "The taxes unfairly benefited French merchants over American merchants.", rationale: "The issue was with British taxation, not benefits for the French. The conflict was between the colonies and Great Britain.", isCorrect: false } ] },
                        { questionNumber: 2, type: 'map', imageUrl: "https://www.latinamericanstudies.org/maps/thirteen_colonies_1775.gif", question: "This map displays the thirteen colonies grouped into three distinct geographical regions. Which statement accurately reflects a key difference between these regions that contributed to tensions leading up to the Revolution?", answerOptions: [ { text: "The New England colonies, with their focus on large-scale plantation agriculture, were most resistant to British trade regulations.", rationale: "This incorrectly describes the New England economy. The Southern colonies were defined by large-scale plantation agriculture.", isCorrect: false }, { text: "The Middle Colonies, being the most ethnically and religiously diverse, were universally loyal to the British Crown.", rationale: "While diverse, the Middle Colonies were not universally loyal; they contained a mix of Patriots and Loyalists, like other regions.", isCorrect: false }, { text: "The Southern Colonies' economy was heavily reliant on cash crops like tobacco and rice, making them particularly vulnerable to British mercantile policies that controlled their trade.", rationale: "Correct. The Southern economy's dependence on exporting specific cash crops made it highly sensitive to British trade laws and taxes (mercantilism), which was a major source of revolutionary sentiment.", isCorrect: true }, { text: "The Proclamation Line of 1763, shown on the map, primarily restricted the growth of the New England colonies.", rationale: "The Proclamation Line restricted westward expansion from all colonies, but it had a greater impact on the Middle and Southern colonies, which had more accessible western frontiers.", isCorrect: false } ] },
                        { questionNumber: 3, type: 'quote', passage: "'We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness.--That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed.' - Declaration of Independence, 1776", question: "The ideas expressed in this excerpt are most directly influenced by which intellectual movement?", answerOptions: [ { text: "The Renaissance", rationale: "The Renaissance focused on art, humanism, and the revival of classical learning, but the direct political philosophy in the quote comes from a later period.", isCorrect: false }, { text: "The Protestant Reformation", rationale: "The Reformation challenged religious authority, but the specific concepts of natural rights and consent of the governed are from the Enlightenment.", isCorrect: false }, { text: "The Enlightenment", rationale: "Correct. Philosophers like John Locke articulated the core ideas of natural (unalienable) rights and the principle that governments derive their legitimacy from the consent of the people they govern. This quote is a direct reflection of Enlightenment political theory.", isCorrect: true }, { text: "The Scientific Revolution", rationale: "The Scientific Revolution emphasized reason and empirical observation, which influenced the Enlightenment, but the political ideas themselves are hallmarks of the Enlightenment.", isCorrect: false } ] },
                        { questionNumber: 4, type: 'knowledge', question: "During the American Revolution, colonists who supported independence were known as Patriots. What was the term for colonists who remained loyal to Great Britain?", answerOptions: [ { text: "Separatists", rationale: "This term is more commonly associated with the Pilgrims who wanted to separate from the Church of England.", isCorrect: false }, { text: "Federalists", rationale: "This term refers to those who supported the ratification of the U.S. Constitution after the Revolution.", isCorrect: false }, { text: "Tories", rationale: "Correct. Colonists who remained loyal to the British Crown were often called Loyalists or, using the name of the British political party that supported the monarchy, Tories.", isCorrect: true }, { text: "Abolitionists", rationale: "This term refers to people who advocated for the abolition of slavery, a movement that gained prominence later.", isCorrect: false } ] },
                        { questionNumber: 5, type: 'text', passage: "In response to the Boston Tea Party in 1773, where colonists destroyed a shipment of British tea, the British Parliament passed a series of punitive measures in 1774 known in the colonies as the Intolerable Acts (or Coercive Acts). These acts closed the port of Boston until the tea was paid for, restricted town meetings in Massachusetts, and allowed British officials accused of crimes to be tried in Britain. These measures were intended to punish Massachusetts and isolate it from the other colonies.", question: "What was the most significant, unintended consequence of the Intolerable Acts?", answerOptions: [ { text: "They successfully forced Massachusetts colonists to pay for the destroyed tea.", rationale: "The acts did not lead to the colonists paying for the tea; instead, they escalated tensions.", isCorrect: false }, { text: "They caused other colonies to sever ties with Massachusetts for fear of similar punishment.", rationale: "The acts had the opposite effect. Instead of isolating Massachusetts, they unified the colonies against what they saw as British tyranny.", isCorrect: false }, { text: "They were repealed after colonial leaders sent a petition to the King.", rationale: "The acts were not repealed and were a direct cause of further revolutionary action.", isCorrect: false }, { text: "They unified the colonies in their opposition to British rule, leading to the First Continental Congress.", rationale: "Correct. Rather than isolating Massachusetts, the harshness of the acts convinced other colonies that their own rights were in jeopardy, prompting them to convene the First Continental Congress to coordinate a response.", isCorrect: true } ] },
                        { questionNumber: 6, type: 'chart', passage: `<div class="passage-text"><b>Comparing Forces in the American Revolution</b><table class="w-full text-left mt-2"><thead><tr class="border-b"><th class="p-2">Factor</th><th class="p-2">Great Britain</th><th class="p-2">American Colonies</th></tr></thead><tbody><tr class="border-b"><td class="p-2 font-semibold">Population</td><td class="p-2">~ 8 million</td><td class="p-2">~ 2.5 million</td></tr><tr class="border-b"><td class="p-2 font-semibold">Military</td><td class="p-2">Large, well-trained army; powerful navy</td><td class="p-2">Small, inexperienced militia; no navy</td></tr><tr class="border-b"><td class="p-2 font-semibold">Leadership</td><td class="p-2">Experienced officers</td><td class="p-2">Committed, capable leaders (e.g., Washington)</td></tr><tr class="border-b"><td class="p-2 font-semibold">Geography</td><td class="p-2">Long supply lines (3,000 miles)</td><td class="p-2">Fighting on home ground; vast territory</td></tr><tr class="border-b"><td class="p-2 font-semibold">Motivation</td><td class="p-2">Hired mercenaries; varied support at home</td><td class="p-2">Fighting for liberty and independence</td></tr></tbody></table></div>`, question: "Based on the chart, which factor provided the most significant advantage for the American colonies in their war against Great Britain?", answerOptions: [ { text: "Superior military training and equipment.", rationale: "The chart clearly indicates that Great Britain, not the colonies, had the superior military.", isCorrect: false }, { text: "A larger and more supportive population base.", rationale: "The chart shows Great Britain had a much larger population.", isCorrect: false }, { text: "Geographical factors and a stronger motivation for fighting.", rationale: "Correct. The chart shows that fighting on their own vast territory (a geographical advantage) and fighting for a cause like independence (a motivational advantage) were key strengths for the Americans, offsetting British military superiority.", isCorrect: true }, { text: "Support from a powerful and established navy.", rationale: "The chart states the colonies had 'no navy' at the outset.", isCorrect: false } ] },
                        { questionNumber: 7, type: 'text', passage: "The American victory at the Battle of Saratoga in 1777 is widely considered the turning point of the Revolutionary War. The defeat of a major British army convinced France that the American colonists could potentially win the war. As a result, France formally recognized American independence and entered the war as an ally of the United States, providing crucial military and financial support that was instrumental in the final victory at Yorktown.", question: "What was the most important strategic outcome of the American victory at Saratoga?", answerOptions: [ { text: "It was the final battle that ended the Revolutionary War.", rationale: "The passage states that the final victory was at Yorktown. Saratoga was a turning point, not the end.", isCorrect: false }, { text: "It secured a crucial foreign alliance with France.", rationale: "Correct. The passage explicitly states that the victory at Saratoga convinced France to become an ally, which provided the 'crucial military and financial support' needed to win the war.", isCorrect: true }, { text: "It resulted in the capture of the British capital in North America.", rationale: "Saratoga was a field victory in upstate New York; it did not involve the capture of a major capital city like New York or Philadelphia at that time.", isCorrect: false }, { text: "It was the first time the colonial militia defeated British regular troops.", rationale: "While a major victory, it was not the first time colonists had successfully engaged British troops (e.g., Lexington and Concord, Bunker Hill). Its strategic importance was in securing the French alliance.", isCorrect: false } ] },
                        { questionNumber: 8, type: 'cause-effect', question: "Which statement best describes the cause-and-effect relationship between the French and Indian War and the American Revolution?", answerOptions: [ { text: "The American victory in the French and Indian War gave the colonies the confidence to declare independence.", rationale: "The war was a victory for the British, with colonists fighting alongside them. The confidence came later from protesting British policies.", isCorrect: false }, { text: "The French and Indian War created a permanent alliance between the British and Native American tribes, angering the colonists.", rationale: "The war fractured relationships between the British and many tribes. The Proclamation of 1763, which restricted colonial settlement, was a greater source of anger.", isCorrect: false }, { text: "The debt Great Britain incurred from the French and Indian War led to taxation policies that angered the colonists.", rationale: "Correct. The war was very expensive for Britain. The subsequent attempt to pay down that debt by taxing the colonies directly, without their political representation, was a primary cause of the Revolution.", isCorrect: true }, { text: "The French, after losing the war, encouraged the American colonies to rebel against their British rulers.", rationale: "French support came much later, after the Revolution had already begun and the colonists proved they could win at Saratoga.", isCorrect: false } ] },
                        { questionNumber: 9, type: 'quote', passage: "'Every thing that is right or reasonable pleads for separation. The blood of the slain, the weeping voice of nature cries, 'TIS TIME TO PART.' - Thomas Paine, Common Sense, 1776", question: "What was the primary purpose of Thomas Paine's pamphlet, Common Sense?", answerOptions: [ { text: "To negotiate a peaceful settlement with King George III.", rationale: "The quote 'TIS TIME TO PART' shows that the purpose was the opposite of seeking a peaceful settlement; it was a call for a definitive break.", isCorrect: false }, { text: "To persuade undecided American colonists to support independence from Britain.", rationale: "Correct. Common Sense was written in plain, powerful language to make a compelling, emotional, and logical case for independence, and it was incredibly effective in swaying public opinion.", isCorrect: true }, { text: "To outline a new system of government for the United States.", rationale: "While Paine argued for a republic, the pamphlet's main goal was to argue for independence itself, not to draft a detailed constitution.", isCorrect: false }, { text: "To recruit soldiers for the Continental Army.", rationale: "While it likely inspired people to fight, its primary purpose was political persuasion, not direct military recruitment.", isCorrect: false } ] },
                        { questionNumber: 10, type: 'image', imageUrl: "https://www.gadsden.info/images/joinordie.jpg", question: "What is the central message of this 1754 political cartoon by Benjamin Franklin?", answerOptions: [ { text: "The American colonies are like a dangerous snake and should be feared by Britain.", rationale: "The cartoon is directed at the colonies themselves, not as a threat to Britain.", isCorrect: false }, { text: "Each colony is independent and stronger on its own than when united with others.", rationale: "The image of the severed snake clearly argues the opposite: that the colonies are weak when divided.", isCorrect: false }, { text: "The colonies must unite in the face of a common threat, or they will be defeated individually.", rationale: "Correct. The severed snake, with each segment representing a colony or region, is a powerful metaphor for the idea that disunity will lead to death (defeat), while unity provides strength and survival.", isCorrect: true }, { text: "The southern colonies (like South Carolina) are more important to colonial defense than the New England colonies.", rationale: "The cartoon does not suggest any colony is more important than another; it argues that all are essential for the whole to survive.", isCorrect: false } ] },
                        { questionNumber: 11, type: 'text', passage: "Following the Revolutionary War, the newly independent states adopted the Articles of Confederation as their first national government. The Articles created a weak central government, reflecting the states' fear of a strong, centralized authority like the British monarchy. Under the Articles, the national Congress had no power to tax, raise a national army, or regulate interstate commerce. These weaknesses quickly became apparent, leading to events like Shays' Rebellion and the eventual call for a new constitutional convention.", question: "The primary weakness of the government formed by the Articles of Confederation was that it...", answerOptions: [ { text: "gave too much power to the executive branch.", rationale: "There was no strong executive branch under the Articles; power was concentrated in a weak Congress.", isCorrect: false }, { text: "lacked the authority to effectively govern and manage the nation.", rationale: "Correct. The inability to tax, raise an army, or regulate trade meant the central government was too weak to manage the nation's finances, defense, or economy, leading to instability.", isCorrect: true }, { text: "favored the larger states over the smaller states.", rationale: "This was a key debate during the Constitutional Convention. Under the Articles, each state had one vote, which was a point of contention but not the primary weakness of the government's overall power.", isCorrect: false }, { text: "created a judicial system that frequently overruled state laws.", rationale: "There was no national judicial system under the Articles of Confederation.", isCorrect: false } ] },
                        { questionNumber: 12, type: 'multi-source', passage: `<p class="passage-text mb-4">The Stamp Act of 1765 was a direct tax imposed by the British Parliament on the colonies of British America. The act required that many printed materials in the colonies be produced on stamped paper produced in London, carrying an embossed revenue stamp. These printed materials included legal documents, magazines, playing cards, newspapers, and many other types of paper used throughout the colonies.</p><img src="https://www.socialstudiesforkids.com/graphics/stampact-stamp.jpg" alt="A Stamp Act stamp" class="question-image w-1/2 mx-auto">`, question: "Based on the text and the image, what was the primary purpose of the Stamp Act?", answerOptions: [ { text: "To ensure all colonial documents were properly authorized and legally valid.", rationale: "While the stamp looked official, its main purpose was revenue collection, not legal validation.", isCorrect: false }, { text: "To raise revenue for the British government by imposing a direct tax on the colonists.", rationale: "Correct. The passage states the stamp was a 'revenue stamp,' and the tax on a wide range of essential paper goods was a direct way for Britain to raise money from the colonies.", isCorrect: true }, { text: "To create a new postal system for the American colonies.", rationale: "The act was about taxing printed materials, not creating a postal service.", isCorrect: false }, { text: "To promote the printing industry in London over colonial printers.", rationale: "While the paper had to come from London, the primary goal was raising money through the tax, not simply promoting London's printers.", isCorrect: false } ] },
                        { questionNumber: 13, type: 'knowledge', question: "Who was appointed Commander-in-Chief of the Continental Army during the American Revolution?", answerOptions: [ { text: "Thomas Jefferson", rationale: "Thomas Jefferson was the primary author of the Declaration of Independence and served as a diplomat, but he was not a military commander.", isCorrect: false }, { text: "Benjamin Franklin", rationale: "Benjamin Franklin was a key diplomat who helped secure the alliance with France, but he did not lead the army.", isCorrect: false }, { text: "John Adams", rationale: "John Adams was a leading voice for independence in the Continental Congress and a diplomat, but not the military leader.", isCorrect: false }, { text: "George Washington", rationale: "Correct. The Second Continental Congress appointed George Washington as the Commander-in-Chief of the Continental Army in 1775, and he led the army throughout the war.", isCorrect: true } ] },
                        { questionNumber: 14, type: 'text', passage: "The Treaty of Paris, signed in 1783, formally ended the American Revolutionary War. The key terms of the treaty included Great Britain's formal recognition of the United States as an independent nation. It also established the boundaries of the new nation, granting the U.S. territory that stretched west to the Mississippi River, north to the Great Lakes, and south to Florida.", question: "Besides the recognition of American independence, what was another significant outcome of the Treaty of Paris?", answerOptions: [ { text: "The United States was required to pay war reparations to Great Britain.", rationale: "The treaty did not require the U.S. to pay reparations to Britain.", isCorrect: false }, { text: "France received all of Britain's former territories in North America.", rationale: "The treaty granted territory to the United States, not France.", isCorrect: false }, { text: "The United States gained a vast amount of new territory, significantly expanding its borders.", rationale: "Correct. The treaty granted the U.S. control of the territory west to the Mississippi River, which was a massive expansion of its land.", isCorrect: true }, { text: "Great Britain agreed to help the United States establish its new government.", rationale: "The treaty ended the war but did not include provisions for Britain to assist in the formation of the U.S. government.", isCorrect: false } ] },
                        { questionNumber: 15, type: 'analysis', passage: `<p class="passage-text mb-4"><b>Historian A:</b> The American Revolution was fundamentally an economic conflict. The British Empire's mercantilist policies, such as the Navigation Acts and various taxes, restricted colonial trade and manufacturing. The core of the dispute was the colonists' desire for economic freedom—the ability to trade with whomever they pleased and to develop their own industries without British interference.</p><p class="passage-text"><b>Historian B:</b> The Revolution was primarily a political and ideological struggle. Colonists saw themselves as freeborn Britons entitled to certain rights, most notably the right to be taxed only by their own elected representatives. When Parliament violated this principle, it was seen as an act of tyranny. The conflict was not about the amount of the tax, but the principle of self-government.</p>`, question: "What is the central point of disagreement between Historian A and Historian B?", answerOptions: [ { text: "Whether the colonists were justified in rebelling.", rationale: "Both historians are explaining the causes of the rebellion, not debating its justification.", isCorrect: false }, { text: "The primary motivation behind the colonists' drive for independence.", rationale: "Correct. Historian A argues the main driver was economic freedom (the desire to make more money), while Historian B argues it was political principle (the right of self-government).", isCorrect: true }, { text: "The date when the American Revolution truly began.", rationale: "Neither historian is concerned with dating the start of the Revolution.", isCorrect: false }, { text: "Whether the British policies were fair to the colonists.", rationale: "Both passages imply the policies led to conflict, but their focus is on the colonists' motivation, not the fairness of British actions from a neutral perspective.", isCorrect: false } ] }
                    ]
                },
                {
                    id: "ss_us_history_new_nation",
                    title: "A New Nation (1783-1824)",
                    description: "Articles of Confederation, Constitutional Convention, Westward Expansion (Louisiana Purchase, Lewis & Clark).",
                    questions: [
                        {"questionNumber": 1, "question": "Analyze the following excerpt from John O'Sullivan's 1845 essay: \"The right of our manifest destiny to overspread and to possess the whole of the continent which Providence has given us for the development of the great experiment of liberty and federated self-government entrusted to us.\"  What concept is O'Sullivan advocating?", "answerOptions": [{"text": "Peaceful negotiation with Native American tribes", "isCorrect": false, "rationale": "This contradicts the aggressive expansionist tone of the quote."}, {"text": "Isolationism and non-intervention in foreign affairs", "isCorrect": false, "rationale": "The quote promotes active expansion, not isolationism."}, {"text": "Manifest Destiny, the belief in the divinely ordained right of the US to expand across North America", "isCorrect": true, "rationale": "This accurately reflects the core message of O'Sullivan's essay, which popularized the term \"Manifest Destiny\"."}, {"text": "The importance of maintaining a balance of power between the US and European colonies", "isCorrect": false, "rationale": "The quote focuses on unilateral US expansion, not a balance of power."}], "passage": "The right of our manifest destiny to overspread and to possess the whole of the continent which Providence has given us for the development of the great experiment of liberty and federated self-government entrusted to us.\nThis argument is not based on any temporary or experimental policy. It is based on the fundamental principles of our government, and is sustained by every consideration of national policy and national safety. It is based on the character and genius of our people, our institutions, and our destiny. It is based on the facts and principles which govern the progress of nations and empires."},
                        {"questionNumber": 9, "question": "Consider this statement: \"The acquisition of the Louisiana Purchase doubled the size of the United States.\" What was a significant impact of this acquisition?", "answerOptions": [{"text": "A significant reduction in the size of the US", "isCorrect": false, "rationale": "The purchase doubled the size of the country."}, {"text": "The prevention of further westward expansion", "isCorrect": false, "rationale": "The purchase opened up vast territories for expansion."}, {"text": "A major expansion of US territory and its resources", "isCorrect": true, "rationale": "The purchase dramatically increased the US's size and resources."}, {"text": "A decrease in national unity and stability", "isCorrect": false, "rationale": "Although it led to debate, it ultimately increased national unity and strength."}], "passage": "The acquisition of the Louisiana Purchase in 1803 doubled the size of the United States.  This monumental land deal dramatically altered the nation's geography and opened up vast territories for exploration and settlement."}
                    ]
                },
                {
                    id: "ss_us_history_divided",
                    title: "A Nation Divided (1824-1877)",
                    description: "Sectionalism, Manifest Destiny, The Civil War, Reconstruction Amendments (13th, 14th, 15th).",
                    questions: [
                        {"questionNumber": 1, "question": "Analyze the following excerpt from Lincoln's Second Inaugural Address: \"With malice toward none, with charity for all, with firmness in the right as God gives us to see the right, let us strive on to finish the work we are in... to bind up the nation's wounds.\"  What is the primary message Lincoln conveys?", "answerOptions": [{"text": "A call for continued fighting and unconditional surrender from the Confederacy.", "isCorrect": false, "rationale": "This contradicts the message of reconciliation and healing expressed in the quote."}, {"text": "An emphasis on punishing the South severely for its role in the war.", "isCorrect": false, "rationale": "This is contrary to the stated goal of charity for all."}, {"text": "A vision of national unity and healing after the war.", "isCorrect": true, "rationale": "The emphasis on 'charity for all' and 'binding up the nation's wounds' clearly indicates a focus on post-war reconciliation."}, {"text": "A declaration that the war was a righteous crusade to abolish slavery.", "isCorrect": false, "rationale": "While the abolition of slavery was an important aspect of the war, this quote focuses more on the process of national healing."}], "passage": "\"With malice toward none, with charity for all, with firmness in the right as God gives us to see the right, let us strive on to finish the work we are in... to bind up the nation's wounds.\" -Abraham Lincoln, Second Inaugural Address"},
                        {"questionNumber": 2, "question": "Consider this quote from Frederick Douglass: \"Power concedes nothing without a demand. It never did and it never will.\"  How does this statement relate to the African American struggle for civil rights during Reconstruction?", "answerOptions": [{"text": "It emphasizes the importance of peaceful negotiation and compromise.", "isCorrect": false, "rationale": "This directly contradicts Douglass's assertion that power concedes nothing without a demand."}, {"text": "It suggests that the fight for civil rights would be effortless and easily won.", "isCorrect": false, "rationale": "This contrasts sharply with Douglass's implication of a difficult struggle."}, {"text": "It highlights the need for a strong and assertive approach to achieving equality.", "isCorrect": true, "rationale": "Douglass's words directly support the idea of actively demanding rights, not passively waiting for them to be granted."}, {"text": "It promotes the idea of complete reliance on the federal government for change.", "isCorrect": false, "rationale": "While federal support was important, the quote focuses on the agency and actions of the oppressed in demanding change."}], "passage": "\"Power concedes nothing without a demand. It never did and it never will.\" -Frederick Douglass"},
                        {"questionNumber": 3, "question": "Read the following: \"The Freedmen's Bureau, established in 1865, aimed to aid formerly enslaved people and refugees.  However, its effectiveness was significantly hampered by limited resources and political opposition.\" What major challenges hindered Reconstruction efforts?", "answerOptions": [{"text": "The complete lack of support from the North and the abolitionist movement.", "isCorrect": false, "rationale": "This is inaccurate; the North, while divided, largely supported Reconstruction."}, {"text": "Widespread and sustained agreement between the North and South over policy.", "isCorrect": false, "rationale": "The opposite is true; great disagreement characterized the period."}, {"text": "Insufficient funding and resistance from Southern whites.", "isCorrect": true, "rationale": "The passage directly points to these factors as reasons for the Bureau's limited effectiveness."}, {"text": "The unwavering support and collaboration of former Confederate leaders.", "isCorrect": false, "rationale": "Former Confederate leaders actively resisted Reconstruction efforts."}], "passage": "The Freedmen's Bureau, established in 1865, aimed to aid formerly enslaved people and refugees.  However, its effectiveness was significantly hampered by limited resources and political opposition."},
                        {"questionNumber": 4, "question": "Analyze the impact of sharecropping on the lives of formerly enslaved people.  Consider this statement: \"While sharecropping offered a pathway to economic independence, it often trapped individuals in a cycle of debt and poverty.\"", "answerOptions": [{"text": "Sharecropping provided immediate wealth and prosperity to formerly enslaved people.", "isCorrect": false, "rationale": "This statement ignores the realities of debt and poverty associated with sharecropping."}, {"text": "Sharecropping was entirely beneficial and devoid of any exploitative practices.", "isCorrect": false, "rationale": "This is an inaccurate and simplistic portrayal of the system."}, {"text": "Sharecropping offered potential economic advancement but frequently resulted in financial hardship.", "isCorrect": true, "rationale": "This accurately reflects the complex reality of sharecropping, highlighting both its potential and its limitations."}, {"text": "Sharecropping was a revolutionary economic system that eradicated poverty in the South.", "isCorrect": false, "rationale": "Sharecropping did not eliminate poverty; rather, it often exacerbated it."}], "passage": "While sharecropping offered a pathway to economic independence, it often trapped individuals in a cycle of debt and poverty."},
                        {"questionNumber": 5, "question": "The Fourteenth Amendment guaranteed citizenship rights to all persons born or naturalized in the United States.  Which group directly benefited most from this?", "answerOptions": [{"text": "Recently arrived European immigrants.", "isCorrect": false, "rationale": "While immigrants benefitted, the amendment's primary aim was to secure citizenship for African Americans."}, {"text": "Native American populations.", "isCorrect": false, "rationale": "Native Americans were not fully included in the citizenship provisions of this amendment."}, {"text": "African Americans.", "isCorrect": true, "rationale": "The Fourteenth Amendment was directly aimed at securing citizenship rights for formerly enslaved people."}, {"text": "Wealthy landowners in the South.", "isCorrect": false, "rationale": "This group already had citizenship; the amendment was focused on formerly enslaved people."}], "passage": "The Fourteenth Amendment guaranteed citizenship rights to all persons born or naturalized in the United States."}
                    ]
                },
                { id: "ss_us_history_industrial", title: "Industrial America (1877-1914)", description: "Industrialization, Immigration, Urbanization, The Progressive Era.", questions: [] },
                { id: "ss_us_history_global", title: "Global Conflicts (1914-1945)", description: "World War I, The Great Depression, World War II.", questions: [] },
                { id: "ss_us_history_modern", title: "The Modern Era (1945-Present)", description: "The Cold War, The Civil Rights Movement, The Vietnam War, Contemporary America.", questions: [] },
            ]
        },
        "Civics & Government": {
            icon: "ScaleIcon",
            description: "Understand the framework of American government and the rights and responsibilities of citizenship.",
            topics: [
                {
                    id: "ss_civics_constitution",
                    title: "The Constitution",
                    description: "Preamble, Articles, and the Bill of Rights.",
                    questions: [
                        { questionNumber: 1, type: 'text', passage: "The U.S. Constitution establishes three distinct branches of government to prevent the concentration of power. The Legislative Branch, composed of the House of Representatives and the Senate, is responsible for creating laws. The Executive Branch, headed by the President, is responsible for implementing and enforcing those laws. The Judicial Branch, which includes the Supreme Court and lower federal courts, is responsible for interpreting the laws.", question: "A bill is passed by both the House and the Senate. The President then signs it. Which branch is now primarily responsible for ensuring this new law is carried out?", answerOptions: [ { text: "The Legislative Branch, because it wrote the law.", rationale: "The Legislative branch's primary role is to create laws, not enforce them after they are passed.", isCorrect: false }, { text: "The Judicial Branch, because it must first rule on the law's constitutionality.", rationale: "The Judicial Branch interprets laws, but usually only after a legal challenge is brought. It does not handle the day-to-day enforcement.", isCorrect: false }, { text: "The Executive Branch, through its various departments and agencies.", rationale: "Correct. The passage states that the Executive Branch is responsible for 'implementing and enforcing' laws.", isCorrect: true }, { text: "All three branches share equal responsibility for enforcement.", rationale: "While all branches are involved with the law, enforcement is the specific duty of the Executive Branch.", isCorrect: false } ] },
                        { questionNumber: 2, type: 'knowledge', question: "The First Amendment to the U.S. Constitution protects several fundamental rights. Which of the following is NOT a right guaranteed by the First Amendment?", answerOptions: [ { text: "Freedom of speech", rationale: "Freedom of speech is a core protection of the First Amendment.", isCorrect: false }, { text: "The right to bear arms", rationale: "Correct. The right to bear arms is guaranteed by the Second Amendment, not the First.", isCorrect: true }, { text: "Freedom of the press", rationale: "Freedom of the press is explicitly protected by the First Amendment.", isCorrect: false }, { text: "The right to peaceably assemble", rationale: "The right to gather peacefully is one of the key freedoms listed in the First Amendment.", isCorrect: false } ] },
                        { questionNumber: 3, type: 'text', passage: "The Fourth Amendment protects citizens from 'unreasonable searches and seizures.' Generally, this means that law enforcement officials must obtain a warrant, based on probable cause, before searching a person's home or property. This principle ensures that citizens have a right to privacy and are secure from arbitrary government intrusion.", question: "Based on the passage, which of the following scenarios would most likely be a violation of the Fourth Amendment?", answerOptions: [ { text: "An officer searches a car after seeing illegal drugs in plain view on the passenger seat.", rationale: "The 'plain view' doctrine is often considered an exception, as there is no expectation of privacy for items left in plain sight.", isCorrect: false }, { text: "Police search a person's home after a judge, presented with evidence, issues a specific warrant.", rationale: "This describes the proper legal procedure and is not a violation.", isCorrect: false }, { text: "Law enforcement enters and searches a suspect's apartment because they have a hunch the suspect is involved in a crime, but they have no warrant.", rationale: "Correct. Searching a home without a warrant or probable cause is a classic example of an unreasonable search and a violation of the Fourth Amendment.", isCorrect: true }, { text: "A school official searches a student's locker based on a reasonable suspicion that it contains a weapon.", rationale: "Courts have often ruled that students have a reduced expectation of privacy at school, and searches based on reasonable suspicion are sometimes permitted.", isCorrect: false } ] },
                        { questionNumber: 4, type: 'text', passage: "The Sixth Amendment guarantees the right to a 'speedy and public trial, by an impartial jury.' It also ensures the right of the accused 'to be confronted with the witnesses against him' and 'to have the Assistance of Counsel for his defence.' These protections are fundamental to the American criminal justice system.", question: "A person is arrested and held in jail for three years awaiting trial. Which Sixth Amendment right has most clearly been violated?", answerOptions: [ { text: "The right to the assistance of counsel.", rationale: "The passage doesn't state whether the person has a lawyer, only that they have been waiting a long time for trial.", isCorrect: false }, { text: "The right to a speedy trial.", rationale: "Correct. A three-year delay before a trial begins would be considered a clear violation of the right to a 'speedy' trial.", isCorrect: true }, { text: "The right to confront witnesses.", rationale: "This right applies during the trial itself, which has not yet occurred.", isCorrect: false }, { text: "The right to an impartial jury.", rationale: "This right also applies to the trial itself. The issue here is the delay before the trial starts.", isCorrect: false } ] },
                        { questionNumber: 5, type: 'knowledge', question: "The power of Judicial Review, established in the case of Marbury v. Madison (1803), allows the Supreme Court to do what?", answerOptions: [ { text: "Impeach the President for high crimes and misdemeanors.", rationale: "The power of impeachment belongs to Congress, not the Supreme Court.", isCorrect: false }, { text: "Veto laws passed by Congress.", rationale: "The power to veto laws belongs to the President.", isCorrect: false }, { text: "Declare laws unconstitutional.", rationale: "Correct. Judicial review is the power of the Judicial Branch to review laws and actions of the other branches and determine if they violate the Constitution.", isCorrect: true }, { text: "Appoint federal judges to lower courts.", rationale: "The President appoints federal judges, with the Senate's approval.", isCorrect: false } ] }
                    ]
                },
                { id: "ss_civics_legislative", title: "The Legislative Branch", description: "Congress, How a Bill Becomes a Law, Powers of Congress.", questions: [] },
                { id: "ss_civics_executive", title: "The Executive Branch", description: "The President, The Cabinet, Powers of the President.", questions: [] },
                { id: "ss_civics_judicial", title: "The Judicial Branch", description: "The Supreme Court, Judicial Review, Landmark Cases.", questions: [] },
                { id: "ss_civics_federalism", title: "Federalism & Elections", description: "Federal vs. State Powers, The Electoral College, Political Parties.", questions: [] },
            ]
        },
        "Economics": {
            icon: "CurrencyDollarIcon",
            description: "Learn about the principles of economics and how they apply to the U.S. and world economies.",
            topics: [
                { id: "ss_econ_foundations", title: "Foundational Concepts", description: "Scarcity, Opportunity Cost, Supply and Demand.", questions: [] },
                { id: "ss_econ_us_economy", title: "The U.S. Economy", description: "Market Systems, Role of Government, Fiscal vs. Monetary Policy.", questions: [] },
            ]
        },
        "Geography and the World": {
            icon: "GlobeAltIcon",
            description: "Analyze geographic information and interpret data to understand global contexts.",
            topics: [
                {
                    id: "ss_geo_map_skills",
                    title: "Map & Data Skills",
                    description: "Reading Maps, Charts, and Graphs (Mean, Median, Mode).",
                    questions: [
                        { questionNumber: 12, type: 'chart', passage: `<div class="passage-text"><b>Supreme Court Appointments by President (1945-1974)</b><table class="w-full text-left mt-2"><thead><tr><th class="p-2 border-b">President</th><th class="p-2 border-b">Number of Appointments</th></tr></thead><tbody><tr class="border-b"><td class="p-2">Harry S. Truman</td><td class="p-2">4</td></tr><tr class="border-b"><td class="p-2">Dwight D. Eisenhower</td><td class="p-2">5</td></tr><tr class="border-b"><td class="p-2">John F. Kennedy</td><td class="p-2">2</td></tr><tr class="border-b"><td class="p-2">Lyndon B. Johnson</td><td class="p-2">2</td></tr><tr class="border-b"><td class="p-2">Richard Nixon</td><td class="p-2">4</td></tr></tbody></table></div>`, question: "Using the data in the chart, what is the median number of Supreme Court appointments made by these presidents?", answerOptions: [ { text: "2", rationale: "This is the minimum number of appointments, but not the median.", isCorrect: false }, { text: "3.4", rationale: "This is the mean (average), not the median.", isCorrect: false }, { text: "4", rationale: "Correct. To find the median, first list the numbers in order: 2, 2, 4, 4, 5. The middle number in this list is 4.", isCorrect: true }, { text: "5", rationale: "This is the maximum number of appointments, but not the median.", isCorrect: false } ] },
                        { questionNumber: 13, type: 'chart', passage: `<div class="passage-text"><b>Supreme Court Appointments by President (1945-1974)</b><table class="w-full text-left mt-2"><thead><tr><th class="p-2 border-b">President</th><th class="p-2 border-b">Number of Appointments</th></tr></thead><tbody><tr class="border-b"><td class="p-2">Harry S. Truman</td><td class="p-2">4</td></tr><tr class="border-b"><td class="p-2">Dwight D. Eisenhower</td><td class="p-2">5</td></tr><tr class="border-b"><td class="p-2">John F. Kennedy</td><td class="p-2">2</td></tr><tr class="border-b"><td class="p-2">Lyndon B. Johnson</td><td class="p-2">2</td></tr><tr class="border-b"><td class="p-2">Richard Nixon</td><td class="p-2">4</td></tr></tbody></table></div>`, question: "What is the mean (average) number of appointments made by the presidents in this period? Round to the nearest tenth.", answerOptions: [ { text: "2.0", rationale: "This represents the mode (most frequent number), not the mean.", isCorrect: false }, { text: "3.4", rationale: "Correct. To find the mean, add the numbers (4 + 5 + 2 + 2 + 4 = 17) and divide by the number of presidents (5). 17 / 5 = 3.4.", isCorrect: true }, { text: "4.0", rationale: "This is the median, not the mean.", isCorrect: false }, { text: "17.0", rationale: "This is the total sum of the appointments, not the average.", isCorrect: false } ] }
                    ]
                },
            ]
        }
    },
    "Reasoning Through Language Arts (RLA)": {
        "Reading Comprehension: Informational Texts": {
            icon: "DocumentTextIcon",
            description: "Develop skills in analyzing non-fiction texts for meaning, purpose, and argument.",
            topics: [
                {
                    id: "rla_reading_main_idea",
                    title: "Main Idea & Details",
                    description: "Finding the central idea and supporting evidence in non-fiction.",
                    type: 'reading',
                    article: {
                        title: "The Rise of Renewable Energy: Powering a Sustainable Future",
                        genre: "Informational Text (Expository Essay)",
                        text: [
                            "For over a century, human civilization has been powered predominantly by fossil fuels—coal, oil, and natural gas. While these energy sources fueled industrial revolutions and unprecedented economic growth, their use has come at a significant environmental cost, most notably climate change driven by greenhouse gas emissions. In response to this mounting crisis, a global energy transition is underway, shifting focus toward renewable sources. These sources, which include solar, wind, hydropower, and geothermal energy, are naturally replenished and produce minimal to no carbon emissions. This transition is not merely an environmental imperative but also a technological and economic evolution, promising a more sustainable and resilient energy future.",
                            "At the forefront of this revolution is solar power, which harnesses the immense energy of the sun. The most common method involves photovoltaic (PV) cells, which directly convert sunlight into electricity. Another approach, concentrated solar power (CSP), uses mirrors to focus sunlight to heat a fluid, which then creates steam to power a turbine. The primary advantages of solar energy are its abundance and its clean nature. However, its main drawback is intermittency—it only generates power when the sun is shining. This necessitates the development of large-scale energy storage solutions, such as advanced batteries, to provide reliable power around the clock. Furthermore, large solar farms require significant land area, which can raise concerns about land use and ecosystem impact.",
                            "Wind power offers another powerful alternative, utilizing turbines to convert the kinetic energy of wind into electricity. Onshore and offshore wind farms are becoming increasingly common sights globally. Wind is a cost-effective and emissions-free source of power, and its cost has decreased dramatically in recent years, making it competitive with traditional energy sources in many regions. Like solar, however, wind is also intermittent; the wind does not always blow. This variability poses a challenge for grid stability. Critics of large wind farms also point to their visual impact on landscapes and potential harm to avian wildlife, such as birds and bats, although careful siting and technological advancements are helping to mitigate these risks.",
                            "Hydropower and geothermal energy provide more consistent, or baseload, power. Hydropower, generated by the force of flowing water turning turbines in dams, is one of the oldest and most established forms of renewable energy. It is highly reliable and can be dispatched on demand. The main limitation is its environmental impact; large dams can alter river ecosystems, disrupt fish migration, and displace communities. Geothermal energy taps into the Earth's internal heat, using steam from underground reservoirs to generate electricity. It is a highly reliable and clean source of energy with a small physical footprint. Its primary constraint is geographical, as it is only economically viable in regions with accessible geothermal activity, such as volcanic zones or areas with tectonic plate boundaries.",
                            "The complete transition to a renewable energy system presents formidable but surmountable challenges. Beyond the intermittency of solar and wind, modernizing the electrical grid to handle decentralized energy sources is a major hurdle. Smart grids, which use digital technology to manage electricity distribution more efficiently, are essential. Advances in battery technology are critical for storing excess energy for when the sun isn't shining or the wind isn't blowing. Furthermore, supportive government policies, such as carbon pricing and tax incentives for renewable installations, play a crucial role in accelerating this transition. While the path is complex, the collective push toward a renewable-powered world represents a fundamental rethinking of our relationship with energy, aiming for a future that is not only prosperous but also environmentally sustainable for generations to come."
                        ]
                    },
                    questions: [
                        { question: "Which of the following statements best expresses the main idea of the passage?", answerOptions: [{text:"Hydropower is the most reliable and established form of renewable energy available today.", isCorrect: false}, {text:"The global shift to renewable energy is a multifaceted response to the environmental impact of fossil fuels, driven by technology and policy.", isCorrect: true}, {text:"The primary challenge of renewable energy is overcoming the high cost of solar panels and wind turbines.", isCorrect: false}, {text:"Fossil fuels, despite their environmental drawbacks, remain the only viable option for large-scale energy production.", isCorrect: false}] },
                        { question: "In paragraphs 2 and 3, the word 'intermittency' is used to describe a key challenge for solar and wind power. This term most nearly means:", answerOptions: [{text:"The high cost of installation.", isCorrect: false}, {text:"The state of being inconsistent or not continuous.", isCorrect: true}, {text:"The potential harm to local wildlife.", isCorrect: false}, {text:"The requirement for large areas of land.", isCorrect: false}] },
                        { question: "According to the passage, what is the primary environmental motivation for transitioning to renewable energy?", answerOptions: [{text:"To reduce the visual impact of power plants on landscapes.", isCorrect: false}, {text:"To mitigate climate change caused by greenhouse gas emissions from fossil fuels.", isCorrect: true}, {text:"To prevent the disruption of fish migration caused by large dams.", isCorrect: false}, {text:"To decrease reliance on foreign energy sources.", isCorrect: false}] },
                        { question: "The passage suggests that a key difference between hydropower/geothermal energy and solar/wind energy is:", answerOptions: [{text:"their cost-effectiveness.", isCorrect: false}, {text:"their geographical limitations.", isCorrect: false}, {text:"their level of reliability and consistency.", isCorrect: true}, {text:"their impact on avian wildlife.", isCorrect: false}] },
                        { question: "According to paragraph 5, what is the primary purpose of developing smart grids?", answerOptions: [{text:"To lower the cost of electricity for consumers by reducing waste.", isCorrect: false}, {text:"To generate more power from existing solar and wind farms.", isCorrect: false}, {text:"To better manage electricity distribution from varied and decentralized sources.", isCorrect: true}, {text:"To provide tax incentives for homeowners to install their own solar panels.", isCorrect: false}] }
                    ]
                },
                { id: "rla_reading_pov", title: "Point of View & Purpose", description: "Analyzing an author's perspective, bias, and reason for writing.", questions: [] },
                { id: "rla_reading_arguments", title: "Analyzing Arguments", description: "Evaluating claims, evidence, and logical reasoning in persuasive texts.", questions: [] },
                { id: "rla_reading_graphics", title: "Interpreting Graphics", description: "Reading charts, graphs, and tables that accompany articles.", questions: [] },
            ]
        },
        "Reading Comprehension: Literary Texts": {
            icon: "BookOpenIcon",
            description: "Learn to interpret literary works by analyzing plot, character, theme, and language.",
            topics: [
                { id: "rla_literary_plot", title: "Plot & Character", description: "Analyzing story structure and character development.", questions: [] },
                { id: "rla_literary_theme", title: "Theme & Figurative Language", description: "Identifying the underlying message and interpreting metaphors, similes, etc.", questions: [] },
            ]
        },
        "Language & Grammar": {
            icon: "PencilIcon",
            description: "Master the rules of English grammar, punctuation, and sentence structure.",
            topics: [
                {
                    id: "rla_grammar_structure",
                    title: "Sentence Structure",
                    description: "Correcting fragments, run-on sentences, and comma splices.",
                    questions: [
                        { questionNumber:1, question: "Choose the correct possessive form: \"The ___ dedication to the project was admirable.\"", answerOptions: [{text:"employees", isCorrect: false}, {text:"employee's", isCorrect: false}, {text:"employees'", isCorrect: true, rationale: "For a plural noun ending in 's' (employees), the possessive is formed by adding an apostrophe after the 's'."}] },
                        { questionNumber:2, question: "Choose the correct homonyms: \"It's important ___ be on time, but it's okay if you're a few minutes late, ___.\"", answerOptions: [{text:"to / too", isCorrect: true, rationale: "'To' is a preposition used here to mean 'in the direction of'. 'Too' is an adverb meaning 'also' or 'in addition'."}, {text:"too / to", isCorrect: false}, {text:"two / to", isCorrect: false}, {text:"to / two", isCorrect: false}] },
                        { questionNumber:3, question: "Choose the correct verb for subject-verb agreement: \"Neither the manager nor the employees ___ happy with the new policy.\"", answerOptions: [{text:"is", isCorrect: false}, {text:"are", isCorrect: true, rationale: "When subjects are joined by 'nor', the verb agrees with the subject closer to it. 'Employees' is plural, so it requires the plural verb 'are'."}, {text:"was", isCorrect: false}, {text:"has been", isCorrect: false}] },
                        { questionNumber:4, question: "Complete the sentence with the correct parallel structure: \"Her responsibilities included writing reports, managing the budget, and ___ new staff.\"", answerOptions: [{text:"to train", isCorrect: false}, {text:"training", isCorrect: true, rationale: "For parallel structure, all items in the list should be in the same grammatical form. 'Writing', 'managing', and 'training' are all gerunds (-ing words)."}, {text:"she trained", isCorrect: false}, {text:"train", isCorrect: false}] },
                        { questionNumber:5, question: "Which option correctly connects the two ideas: \"The report was due Friday ___ we finished it on Thursday.\"", answerOptions: [{text:"Friday we", isCorrect: false}, {text:"Friday, we", isCorrect: false}, {text:"Friday, so we", isCorrect: true, rationale: "These are two independent clauses. They must be separated by a comma and a coordinating conjunction like 'so' to show the cause-and-effect relationship."}, {text:"Friday but we", isCorrect: false}] }
                    ]
                },
                {
                    id: "rla_grammar_punctuation",
                    title: "Punctuation & Mechanics",
                    description: "Proper use of commas, semicolons, apostrophes, and capitalization.",
                    questions: [
                        { questionNumber:1, question: "Choose the correctly punctuated sentence.", answerOptions: [{text:"She bought apples bananas, and oranges.", isCorrect: false}, {text:"She bought apples, bananas and oranges.", isCorrect: false}, {text:"She bought apples, bananas, and oranges.", isCorrect: true, rationale: "Use commas to separate three or more items in a list or series. Standard practice includes the final comma before 'and' (the Oxford comma)."}, {text:"She bought apples; bananas, and oranges.", isCorrect: false}] },
                        { questionNumber:2, question: "Which sentence has the correct subject-verb agreement?", answerOptions: [{text:"The team of players are ready to compete.", isCorrect: false}, {text:"The team of players were ready to compete.", isCorrect: false}, {text:"The team of players is ready to compete.", isCorrect: true, rationale: "The subject is 'team,' which is a singular noun, even though it contains plural members ('players'). Therefore, it requires the singular verb 'is'."}, {text:"The team of players being ready to compete.", isCorrect: false}] },
                        { questionNumber:3, question: "Choose the correctly capitalized sentence.", answerOptions: [{text:"I have a meeting with Doctor smith on Tuesday.", isCorrect: false}, {text:"I have a meeting with doctor Smith on tuesday.", isCorrect: false}, {text:"I have a meeting with Doctor Smith on Tuesday.", isCorrect: true, rationale: "Titles like 'Doctor' should be capitalized when used with a specific name. Days of the week, like 'Tuesday,' are proper nouns and must be capitalized."}, {text:"I have a meeting with doctor smith on Tuesday.", isCorrect: false}] },
                        { questionNumber:4, question: "Which sentence uses the apostrophe correctly?", answerOptions: [{text:"The dog wagged it's tail happily.", isCorrect: false}, {text:"The dog wagged its tail happily.", isCorrect: true, rationale: "'Its' is the possessive form of 'it'. 'It's' is a contraction for 'it is'. The tail belongs to the dog, so the possessive 'its' is correct."}, {text:"The dog wagged its' tail happy.", isCorrect: false}, {text:"The dog wagged it's tail happy.", isCorrect: false}] },
                        { questionNumber:5, question: "Which sentence uses a comma correctly?", answerOptions: [ {text:"Although she was tired she finished her homework.", isCorrect: false}, {text:"Although, she was tired, she finished her homework.", isCorrect: false}, {text:"Although she was tired, she finished her homework.", isCorrect: true, rationale: "A comma should be placed after an introductory dependent clause, such as 'Although she was tired'."}, {text:"Although she was tired she, finished her homework.", isCorrect: false} ] }
                    ]
                },
                {
                    id: "rla_grammar_usage",
                    title: "Grammar & Usage",
                    description: "Subject-verb agreement, pronoun usage, and correct word choice.",
                    questions: [
                        { question: "Choose the correct relative pronoun to complete the sentence: 'The manager, ___ I met this morning, was very helpful.'", answerOptions: [{text:"who", isCorrect: false}, {text:"whom", isCorrect: true, rationale: "'Whom' is the correct choice because it is the object of the verb 'met' (I met whom). 'Who' is used for subjects."}, {text:"which", isCorrect: false}, {text:"that", isCorrect: false}] },
                        { question: "Which sentence is correctly punctuated?", answerOptions: [{text:"My car which is ten years old, still runs perfectly.", isCorrect: false}, {text:"My car, which is ten years old, still runs perfectly.", isCorrect: true, rationale: "The clause 'which is ten years old' is non-essential (it adds extra information). Non-essential clauses must be set off by commas and should use 'which', not 'that'."}, {text:"My car that is ten years old still runs perfectly.", isCorrect: false}, {text:"My car, that is ten years old, still runs perfectly.", isCorrect: false}] },
                        { question: "Choose the correct relative pronoun: 'She is the artist ___ paintings are displayed in the gallery.'", answerOptions: [{text:"who", isCorrect: false}, {text:"whose", isCorrect: true, rationale: "'Whose' is a possessive pronoun used to show that the paintings belong to the artist."}, {text:"whom", isCorrect: false}, {text:"which", isCorrect: false}] },
                        { question: "Which sentence implies that ONLY SOME of the computers are faster?", answerOptions: [{text:"The computers, which have the new software, are faster.", isCorrect: false}, {text:"The computers that have the new software are faster.", isCorrect: true, rationale: "Using 'that' without commas creates an essential clause. This specifies that *only the group of computers with the new software* is faster, not all of them."}, {text:"The computers are faster, which have the new software.", isCorrect: false}, {text:"The faster computers have the new software.", isCorrect: false}] },
                        { question: "Identify the adjective clause in the following sentence: 'The woman who is speaking now is our new CEO.'", answerOptions: [{text:"The woman", isCorrect: false}, {text:"who is speaking now", isCorrect: true, rationale: "An adjective clause typically starts with a relative pronoun (who, which, that) and modifies a noun. Here, 'who is speaking now' describes 'The woman'."}, {text:"is our new CEO", isCorrect: false}, {text:"speaking now is our", isCorrect: false}] }
                    ]
                },
            ]
        },
        "Writing Skills: The Extended Response": {
            icon: "ChatBubbleLeftRightIcon",
            description: "Develop the skills needed to write a high-scoring Extended Response essay.",
            topics: [
                { id: "rla_writing_guide", title: "Interactive Essay Guide", description: "Templates and sentence starters for the Extended Response.", type: 'essay', questions: [] },
                { id: "rla_writing_prompts", title: "Practice Prompts", description: "A library of sample essay prompts based on paired passages.", type: 'essay', questions: [] },
            ]
        }
    }
};


// --- ICON COMPONENTS ---
const AcademicCapIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5z" /></svg>;
const ScaleIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0012 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 01-2.036.243c-2.132 0-4.14-.818-5.62-2.24l-2.62-2.62a1.5 1.5 0 00-2.122 0l-2.62 2.62a6 6 0 01-5.62 2.24m6.36-9.32l2.62-10.727a.527.527 0 01.589-.424a5.987 5.987 0 012.036-.243c2.132 0 4.14.818 5.62 2.24l2.62 2.62a1.5 1.5 0 002.122 0l2.62-2.62a6 6 0 015.62-2.24M6.36 15.18l-2.62 10.727a.527.527 0 01-.589.424a5.987 5.987 0 01-2.036.243c-2.132 0-4.14-.818-5.62-2.24l-2.62-2.62a1.5 1.5 0 00-2.122 0l-2.62 2.62a6 6 0 01-5.62-2.24" /></svg>;
const CurrencyDollarIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
const GlobeAltIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" /></svg>;
const DocumentTextIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>;
const BookOpenIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>;
const PencilIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg>;
const ChatBubbleLeftRightIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193l-3.722.28c-1.43.108-2.802-.57-3.634-1.765L12 15.75m0 0l-1.406-2.013a2.25 2.25 0 00-3.634-1.765l-3.722-.28A2.25 2.25 0 013 14.894V10.608c0-.97.616-1.813 1.5-2.097m14.25 0a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25m14.25 0l-3.722 2.8c-1.43.108-2.802.57-3.634 1.765L12 15.75m0 0l-1.406 2.013a2.25 2.25 0 00-3.634 1.765l-3.722.28A2.25 2.25 0 013 14.894V10.608c0-.97.616-1.813 1.5-2.097" /></svg>;
const SparklesIcon = ({ className = "h-6 w-6" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM18 15.75l.813 2.846a4.5 4.5 0 003.09 3.09L24 12l-2.846-.813a4.5 4.5 0 00-3.09-3.09L18 5.25l-.813 2.846a4.5 4.5 0 00-3.09 3.09L11.25 12l2.846.813a4.5 4.5 0 003.09 3.09z" /></svg>;
const ArrowLeftIcon = ({ className = "h-5 w-5" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" /></svg>;
const ChevronDownIcon = ({ className = "h-5 w-5" }) => <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2.5} stroke="currentColor" className={className}><path strokeLinecap="round" strokeLinejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>;


// --- Helper Functions ---
const shuffleArray = (array) => {
    if (!Array.isArray(array)) {
        console.error("shuffleArray received a non-array value:", array);
        return [];
    }
    let newArray = [...array];
    for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
    }
    return newArray;
};

// --- Main App Component ---
function App() {
    const [view, setView] = useState('start'); 
    const [activeQuiz, setActiveQuiz] = useState(null);
    const [quizResults, setQuizResults] = useState(null);
    const [activeGenerator, setActiveGenerator] = useState(null);
    const [progress, setProgress] = useState(() => {
        try {
            const savedProgress = localStorage.getItem('ged-progress');
            return savedProgress ? JSON.parse(savedProgress) : {
                quizzesTaken: 0,
                totalCorrect: 0,
                totalQuestions: 0,
                totalTime: 0,
            };
        } catch (error) {
            console.error("Could not parse progress from localStorage", error);
            return { quizzesTaken: 0, totalCorrect: 0, totalQuestions: 0, totalTime: 0 };
        }
    });

    const updateProgress = (result, timeSpent) => {
        setProgress(prev => {
            const newProgress = {
                quizzesTaken: prev.quizzesTaken + 1,
                totalCorrect: prev.totalCorrect + result.score,
                totalQuestions: prev.totalQuestions + result.totalQuestions,
                totalTime: prev.totalTime + timeSpent,
            };
            localStorage.setItem('ged-progress', JSON.stringify(newProgress));
            return newProgress;
        });
    };

    const startQuiz = (quiz) => {
        const shuffledQuiz = {
            ...quiz,
            questions: quiz.questions ? quiz.questions.map(q => ({
                ...q,
                answerOptions: shuffleArray(q.answerOptions)
            })) : []
        };
        setActiveQuiz(shuffledQuiz);
        setView(quiz.type || 'quiz');
    };
    
    const onQuizComplete = (results, timeSpent) => {
        updateProgress(results, timeSpent);
        setQuizResults(results);
        setView('results');
    };

    const navigateHome = () => {
        setView('start');
        setActiveQuiz(null);
        setQuizResults(null);
        setActiveGenerator(null);
    };

    const renderView = () => {
        switch (view) {
            case 'quiz':
                return <QuizRunner quiz={activeQuiz} onComplete={onQuizComplete} onExit={navigateHome} />;
            case 'reading':
                 return <ReadingPractice quiz={activeQuiz} onComplete={onQuizComplete} onExit={navigateHome} />;
            case 'essay':
                return <EssayGuide onExit={navigateHome} />;
            case 'simulation':
                return <div className="text-center p-8"><h1 className="text-2xl font-bold">The Game of Life Simulation</h1><p className="my-4">This feature is coming soon!</p><button onClick={navigateHome} className="mt-4 px-4 py-2 bg-sky-500 text-white rounded">Go Back</button></div>;
            case 'results':
                return <ResultsScreen results={quizResults} quizTitle={activeQuiz.title} onRestart={() => startQuiz(activeQuiz)} onHome={navigateHome} />;
            case 'generator':
                return <AIQuizGenerator subject={activeGenerator} onQuizGenerated={startQuiz} onExit={navigateHome} />;
            case 'start':
            default:
                return (
                    <StartScreen 
                        progress={progress}
                        onSelectQuiz={startQuiz} 
                        onSelectGenerator={(subject) => { setActiveGenerator(subject); setView('generator'); }}
                    />
                );
        }
    };

    return (
        <div className="w-full max-w-5xl mx-auto bg-slate-100 p-4 sm:p-6 md:p-8">
            {renderView()}
        </div>
    );
}

// --- VIEWS & COMPONENTS ---

function ProgressDashboard({ progress }) {
    const averageScore = progress.totalQuestions > 0 ? Math.round((progress.totalCorrect / progress.totalQuestions) * 100) : 0;
    const timeSpent = Math.floor(progress.totalTime / 60); // in minutes

    return (
        <div className="mb-8 p-6 bg-slate-800 text-white rounded-xl shadow-lg">
            <h2 className="text-2xl font-bold mb-4 text-amber-400">Your Progress Dashboard</h2>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                <div className="p-4 bg-slate-700 rounded-lg">
                    <p className="text-4xl font-bold text-sky-400">{progress.quizzesTaken}</p>
                    <p className="text-slate-300 font-medium">Quizzes Taken</p>
                </div>
                <div className="p-4 bg-slate-700 rounded-lg">
                    <p className="text-4xl font-bold text-sky-400">{averageScore}<span className="text-2xl">%</span></p>
                    <p className="text-slate-300 font-medium">Average Score</p>
                </div>
                <div className="p-4 bg-slate-700 rounded-lg">
                    <p className="text-4xl font-bold text-sky-400">{timeSpent}<span className="text-2xl"> min</span></p>
                    <p className="text-slate-300 font-medium">Time Spent Studying</p>
                </div>
            </div>
        </div>
    );
}


function StartScreen({ progress, onSelectQuiz, onSelectGenerator }) {
    const [path, setPath] = useState([]); // e.g., ["Social Studies", "U.S. History"]

    const navigateTo = (newPath) => setPath(newPath);
    const goBack = () => setPath(path.slice(0, -1));
    const goHome = () => setPath([]);

    const getIcon = (iconName, props) => {
        const icons = {
            AcademicCapIcon, ScaleIcon, CurrencyDollarIcon, GlobeAltIcon,
            DocumentTextIcon, BookOpenIcon, PencilIcon, ChatBubbleLeftRightIcon, SparklesIcon
        };
        const IconComponent = icons[iconName];
        return IconComponent ? <IconComponent {...props} /> : null;
    };

    const renderBreadcrumbs = () => (
        <nav className="flex items-center text-sm font-medium text-slate-500 mb-6">
            <button onClick={goHome} className="hover:text-sky-600">Home</button>
            {path.map((segment, index) => (
                <div key={index} className="flex items-center">
                    <span className="mx-2">/</span>
                    <button onClick={() => navigateTo(path.slice(0, index + 1))} className="hover:text-sky-600">{segment}</button>
                </div>
            ))}
        </nav>
    );

    let currentData;
    let viewLevel = 'subjects';
    if (path.length === 0) {
        currentData = AppData;
    } else {
        currentData = path.reduce((acc, key) => acc[key], AppData);
        if (currentData.topics) {
            viewLevel = 'topics';
        } else {
            viewLevel = 'categories';
        }
    }

    return (
        <div className="fade-in">
            <header className="text-center pb-6 mb-6 border-b border-slate-200">
                <h1 className="text-4xl font-extrabold text-slate-800 tracking-tight">Mr. Smith's Learning Canvas</h1>
                <p className="text-slate-500 mt-2 text-lg">Your comprehensive GED preparation platform.</p>
            </header>

            {path.length === 0 && <ProgressDashboard progress={progress} />}

            {path.length > 0 && renderBreadcrumbs()}

            <div className={`grid grid-cols-1 md:grid-cols-2 ${viewLevel === 'topics' ? 'lg:grid-cols-2' : 'lg:grid-cols-3'} gap-6`}>
                {viewLevel !== 'topics' && (
                    <div
                        className="bg-gradient-to-br from-sky-500 to-sky-600 rounded-lg p-6 flex flex-col justify-center items-center text-white shadow-lg cursor-pointer hover:shadow-xl transition-shadow"
                        onClick={() => onSelectGenerator(path[0] || 'Social Studies')}
                    >
                        {getIcon("SparklesIcon", { className: "h-12 w-12 mb-2" })}
                        <h3 className="text-2xl font-bold">AI Quiz Generator</h3>
                        <p className="text-center text-sky-100 mt-1">Create a custom practice quiz on any topic.</p>
                    </div>
                )}

                {Object.entries(currentData).map(([name, data]) => {
                    if(name === "icon" || name === "description") return null;

                    const isQuiz = !!data.questions || data.type === 'essay';

                    return (
                        <div
                            key={name}
                            className="bg-white rounded-lg p-6 shadow-md hover:shadow-lg hover:-translate-y-1 transition-all duration-300 cursor-pointer flex flex-col"
                            onClick={() => isQuiz ? onSelectQuiz(data) : navigateTo([...path, name])}
                        >
                            <div className="flex items-center mb-3">
                                {getIcon(data.icon, { className: "h-8 w-8 text-sky-500" })}
                                <h3 className="text-2xl font-bold text-slate-800 ml-3">{name}</h3>
                            </div>
                            <p className="text-slate-600 flex-grow">{data.description}</p>
                            <button className="w-full mt-4 px-4 py-2 bg-sky-500 text-white font-semibold rounded-md hover:bg-sky-600 transition-colors">
                                {isQuiz ? "Start Practice" : "View Topics"}
                            </button>
                        </div>
                    );
                })}
            </div>
        </div>
    );
}

function QuizRunner({ quiz, onComplete, onExit }) {
    const [currentIndex, setCurrentIndex] = useState(0);
    const [answers, setAnswers] = useState(Array(quiz.questions.length).fill(null));
    const [marked, setMarked] = useState(Array(quiz.questions.length).fill(false));
    const [timeLeft, setTimeLeft] = useState(quiz.questions.length * 90);
    
    useEffect(() => {
        const timer = setInterval(() => {
            setTimeLeft(prev => {
                if (prev <= 1) {
                    clearInterval(timer);
                    handleSubmitRef.current();
                    return 0;
                }
                return prev - 1;
            });
        }, 1000);
        return () => clearInterval(timer);
    }, [quiz]);

    const handleSelect = (optionText) => {
        const newAnswers = [...answers];
        newAnswers[currentIndex] = optionText;
        setAnswers(newAnswers);
    };

    const handleSubmit = useCallback(() => {
        const timeSpent = (quiz.questions.length * 90) - timeLeft;
        let score = 0;
        quiz.questions.forEach((q, i) => {
            const correctOption = q.answerOptions.find(opt => opt.isCorrect);
            if (correctOption && answers[i] === correctOption.text) {
                score++;
            }
        });

        const percentage = (score / quiz.questions.length) * 100;
        const scaledScore = Math.round(percentage < 65 ? 100 + (percentage / 65 * 44) : 145 + ((percentage - 65) / 35 * 55));
        
        onComplete({ score, totalQuestions: quiz.questions.length, scaledScore, answers }, timeSpent);
    }, [answers, quiz, onComplete, timeLeft]);

    const handleSubmitRef = useRef(handleSubmit);
    useEffect(() => {
        handleSubmitRef.current = handleSubmit;
    }, [handleSubmit]);

    const formatTime = (seconds) => `${Math.floor(seconds / 60)}:${(seconds % 60).toString().padStart(2, '0')}`;

    const currentQ = quiz.questions[currentIndex];
    
    return (
        <div className="fade-in">
            <header className="flex justify-between items-center pb-4 mb-4 border-b">
                 <button onClick={onExit} className="flex items-center gap-1 text-sm text-slate-600 hover:text-sky-600 font-semibold"><ArrowLeftIcon /> Back</button>
                 <h2 className="text-xl font-bold text-center text-slate-800">{quiz.title}</h2>
                 <div className="font-bold text-red-600">{formatTime(timeLeft)}</div>
            </header>

            <div className="mb-4 flex flex-wrap gap-2 quiz-nav">
                {quiz.questions.map((_, i) => (
                    <button key={i} onClick={() => setCurrentIndex(i)} className={`w-8 h-8 rounded-full font-bold text-sm ${i === currentIndex ? 'bg-sky-600 text-white' : answers[i] !== null ? 'bg-sky-200' : 'bg-slate-200'} ${marked[i] ? 'ring-2 ring-yellow-400' : ''}`}>
                        {i + 1}
                    </button>
                ))}
            </div>
            
            <div className="p-4 bg-slate-50 rounded-lg">
                {currentQ.passage && <div className="mb-4 prose max-w-none" dangerouslySetInnerHTML={{ __html: currentQ.passage }} />}
                {currentQ.imageUrl && <img src={currentQ.imageUrl} alt="Question image" className="my-4 mx-auto rounded-md border" />}
                <h3 className="text-xl font-semibold mb-4">{currentQ.questionNumber}. {currentQ.question}</h3>
                <div className="space-y-3">
                    {currentQ.answerOptions.map((opt, i) => (
                        <button key={i} onClick={() => handleSelect(opt.text)} className={`w-full text-left p-3 rounded-lg border-2 transition ${answers[currentIndex] === opt.text ? 'bg-sky-100 border-sky-500' : 'bg-white hover:bg-sky-50 border-white'}`}>
                           <span className="font-bold mr-2">{String.fromCharCode(65 + i)}.</span> {opt.text}
                        </button>
                    ))}
                </div>
            </div>

            <div className="mt-6 flex justify-between">
                <button onClick={() => setCurrentIndex(p => Math.max(0, p - 1))} disabled={currentIndex === 0} className="px-4 py-2 bg-slate-200 rounded-md disabled:opacity-50">Previous</button>
                <button onClick={() => setMarked(m => { const newM = [...m]; newM[currentIndex] = !newM[currentIndex]; return newM; })} className={`px-4 py-2 rounded-md ${marked[currentIndex] ? 'bg-yellow-300' : 'bg-slate-200'}`}>
                    Mark for Review
                </button>
                {currentIndex === quiz.questions.length - 1 ? (
                    <button onClick={handleSubmit} className="px-4 py-2 bg-green-500 text-white rounded-md">Finish</button>
                ) : (
                    <button onClick={() => setCurrentIndex(p => Math.min(quiz.questions.length - 1, p + 1))} className="px-4 py-2 bg-sky-500 text-white rounded-md">Next</button>
                )}
            </div>
        </div>
    );
}

function ResultsScreen({ results, quizTitle, onRestart, onHome }) {
    const getPerf = (score) => {
        if (score >= 175) return { level: "GED® College Ready + Credit", color: "text-purple-600" };
        if (score >= 165) return { level: "GED® College Ready", color: "text-blue-600" };
        if (score >= 145) return { level: "GED® Passing Score", color: "text-green-600" };
        return { level: "Keep studying!", color: "text-amber-600" };
    };

    const performance = getPerf(results.scaledScore);

    return (
        <div className="text-center fade-in">
            <h2 className="text-3xl font-bold text-slate-800">Results: {quizTitle}</h2>
            <div className="my-6">
                <p className="text-lg text-slate-600">Your estimated GED® Score is:</p>
                <p className={`text-6xl font-bold my-2 ${performance.color}`}>{results.scaledScore}</p>
                <p className={`text-2xl font-semibold mb-2 ${performance.color}`}>{performance.level}</p>
                <p className="text-lg text-slate-500">{results.score} / {results.totalQuestions} Correct</p>
            </div>
             <div className="mt-8 flex justify-center gap-4">
                 <button onClick={onHome} className="px-6 py-2 bg-slate-600 text-white font-bold rounded-lg hover:bg-slate-700">Go Home</button>
                 <button onClick={onRestart} className="px-6 py-2 bg-sky-600 text-white font-bold rounded-lg hover:bg-sky-700">Try Again</button>
            </div>
        </div>
    );
}

function ReadingPractice({ quiz, onComplete, onExit }) {
    const [answers, setAnswers] = useState({});
    const [isSubmitted, setIsSubmitted] = useState(false);
    const startTime = useRef(new Date());

    const handleAnswer = (qIndex, answer) => {
        if(isSubmitted) return;
        setAnswers(prev => ({ ...prev, [qIndex]: answer }));
    };

    const handleSubmit = () => {
        if (Object.keys(answers).length !== quiz.questions.length) {
            if(!confirm("You have unanswered questions. Are you sure you want to submit?")) {
                return;
            }
        }
        const endTime = new Date();
        const timeSpent = Math.round((endTime - startTime.current) / 1000); // Time in seconds
        setIsSubmitted(true);
        let score = 0;
        quiz.questions.forEach((q, i) => {
             const correctOption = q.answerOptions.find(opt => opt.isCorrect);
            if(correctOption && answers[i] === correctOption.text) {
                score++;
            }
        });
        const percentage = (score / quiz.questions.length) * 100;
        const scaledScore = Math.round(percentage < 65 ? 100 + (percentage / 65 * 44) : 145 + ((percentage - 65) / 35 * 55));
        onComplete({ score, totalQuestions: quiz.questions.length, scaledScore }, timeSpent);
    };

    return (
        <div className="fade-in">
             <header className="flex justify-between items-center pb-4 mb-4 border-b">
                 <button onClick={onExit} className="flex items-center gap-1 text-sm text-slate-600 hover:text-sky-600 font-semibold"><ArrowLeftIcon /> Back</button>
                 <h2 className="text-xl font-bold text-center text-slate-800">{quiz.title}</h2>
                 <div></div>
            </header>
            <article className="prose max-w-none">
                <h3 className="text-2xl font-bold">{quiz.article.title}</h3>
                <p className="text-sm italic text-slate-500">{quiz.article.genre}</p>
                {quiz.article.text.map((p, i) => <p key={i}>{p}</p>)}
            </article>
            <section className="mt-8 pt-6 border-t">
                <h3 className="text-2xl font-bold mb-4">Questions</h3>
                <div className="space-y-6">
                    {quiz.questions.map((q, i) => (
                        <div key={i} className={`p-4 rounded-lg transition-colors ${isSubmitted ? (answers[i] === q.answerOptions.find(o=>o.isCorrect).text ? 'bg-green-50' : 'bg-red-50') : 'bg-slate-50'}`}>
                            <p className="font-semibold">{i+1}. {q.question}</p>
                            <div className="mt-2 space-y-1">
                                {q.answerOptions.map((opt, j) => (
                                    <label key={j} className={`flex items-center p-2 rounded cursor-pointer ${answers[i] === opt.text ? 'bg-slate-200': 'hover:bg-slate-100'}`}>
                                        <input type="radio" name={`q${i}`} value={opt.text} onChange={() => handleAnswer(i, opt.text)} disabled={isSubmitted} className="mr-2"/>
                                        <span className={`${isSubmitted && opt.isCorrect ? 'font-bold text-green-700' : ''} ${isSubmitted && answers[i] === opt.text && !opt.isCorrect ? 'line-through text-red-700' : ''}`}>{opt.text}</span>
                                    </label>
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
                {!isSubmitted && <button onClick={handleSubmit} className="mt-6 w-full px-6 py-3 bg-sky-600 text-white font-bold rounded-lg hover:bg-sky-700">Submit Answers</button>}
            </section>
        </div>
    );
}

function EssayGuide({ onExit }) {
    const [intro, setIntro] = useState('');
    const [body1, setBody1] = useState('');
    const [conclusion, setConclusion] = useState('');

    const templates = {
        intro: "The two passages present conflicting views on [topic]. The author of Passage 1 argues that [claim 1]. Conversely, the author of Passage 2 claims that [claim 2]. After analyzing both texts, it is clear that the argument in Passage [1 or 2] is more convincing because it is better supported by [type of evidence 1] and [type of evidence 2].",
        body1: "The author of the stronger passage effectively builds their argument by using [type of evidence]. For example, the author states, \"[direct quote or paraphrase]\". This evidence is convincing because it [explains why the evidence is logical and relevant]. In contrast, the opposing passage offers weaker support on this point by [describe weaker evidence].",
        conclusion: "In conclusion, while both authors address the issue of [topic], the author of Passage [1 or 2] presents a more compelling and well-supported argument. Through the skillful use of [restate evidence types], the author builds a more persuasive case than the comparatively weaker claims made by the other author."
    };

    const sentenceStarters = {
        body: [
            "To begin,",
            "One key piece of evidence is...",
            "The author effectively argues that...",
            "Furthermore,",
            "Additionally,",
            "In contrast,",
            "On the other hand,",
        ],
        conclusion: [
            "In summary,",
            "To conclude,",
            "Ultimately,",
            "Based on the evidence,",
        ]
    };

    const insertText = (target, text) => {
        if (target === 'intro') setIntro(prev => prev ? `${prev} ${text}` : text);
        if (target === 'body1') setBody1(prev => prev ? `${prev} ${text}` : text);
        if (target === 'conclusion') setConclusion(prev => prev ? `${prev} ${text}` : text);
    };

    const EssaySection = ({ title, placeholder, value, onChange, template, starters, onInsert }) => (
        <div className="bg-white p-4 rounded-lg shadow-sm">
            <h3 className="text-xl font-bold text-slate-700 mb-2">{title}</h3>
            <div className="flex flex-wrap gap-2 mb-2">
                <button onClick={() => onInsert(template)} className="px-3 py-1 bg-amber-400 text-amber-900 font-semibold rounded-md text-sm hover:bg-amber-500 transition-colors">Use Template</button>
                {starters && starters.map(starter => (
                    <button key={starter} onClick={() => onInsert(starter)} className="px-3 py-1 bg-sky-100 text-sky-800 font-semibold rounded-md text-sm hover:bg-sky-200 transition-colors">{starter}</button>
                ))}
            </div>
            <textarea
                className="w-full h-36 p-3 border border-slate-300 rounded-md focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition"
                placeholder={placeholder}
                value={value}
                onChange={onChange}
            ></textarea>
        </div>
    );

    return (
        <div className="fade-in">
             <header className="flex justify-between items-center pb-4 mb-4 border-b border-slate-200">
                 <button onClick={onExit} className="flex items-center gap-2 text-sm text-slate-600 hover:text-sky-600 font-semibold"><ArrowLeftIcon /> Back</button>
                 <h2 className="text-2xl font-bold text-center text-slate-800">Interactive Essay Guide</h2>
                 <div></div>
            </header>
            <div className="space-y-6">
                <EssaySection
                    title="Introduction Paragraph"
                    placeholder="Start your introduction here..."
                    value={intro}
                    onChange={(e) => setIntro(e.target.value)}
                    template={templates.intro}
                    onInsert={(text) => insertText('intro', text)}
                />
                <EssaySection
                    title="Body Paragraph #1"
                    placeholder="Build your first body paragraph..."
                    value={body1}
                    onChange={(e) => setBody1(e.target.value)}
                    template={templates.body1}
                    starters={sentenceStarters.body}
                    onInsert={(text) => insertText('body1', text)}
                />
                 <EssaySection
                    title="Conclusion"
                    placeholder="Summarize your analysis..."
                    value={conclusion}
                    onChange={(e) => setConclusion(e.target.value)}
                    template={templates.conclusion}
                    starters={sentenceStarters.conclusion}
                    onInsert={(text) => insertText('conclusion', text)}
                />
            </div>
        </div>
    );
}

function AIQuizGenerator({ subject, onQuizGenerated, onExit }) {
    const [selectedTopic, setSelectedTopic] = useState('');
    const [isGenerating, setIsGenerating] = useState(false);
    const [error, setError] = useState(null);

    const availableTopics = Object.values(AppData[subject])
        .flatMap(category => category.topics ? category.topics.map(topic => topic.title) : []);

    const handleGenerate = async () => {
        if (!selectedTopic) {
            setError("Please select a topic first.");
            return;
        }
        setIsGenerating(true);
        setError(null);

        const maxRetries = 3;
        let attempt = 0;
        let delay = 1000; // Start with a 1-second delay

        const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

        while (attempt < maxRetries) {
            try {
                const response = await fetch('https://ged-website.onrender.com/generate-quiz', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ subject, topic: selectedTopic })
                });

                // If the server is overloaded, throw a specific error to trigger a retry
                if (response.status === 503) {
                    throw new Error('Model is overloaded');
                }

                if (!response.ok) {
                    const errorResult = await response.json();
                    throw new Error(errorResult.error || `Request failed with status ${response.status}`);
                }

                // If successful, process the response and exit the function
                const result = await response.json();
                const jsonText = result.candidates[0].content.parts[0].text;
                const generatedQuiz = JSON.parse(jsonText);

                generatedQuiz.questions.forEach(q => {
                    const correctRationale = q.answerOptions.find(opt => opt.isCorrect)?.rationale || "This is the correct answer.";
                    q.answerOptions.forEach(opt => {
                        if (!opt.rationale) {
                            opt.rationale = opt.isCorrect ? correctRationale : "This is not the correct answer.";
                        }
                    });
                });

                generatedQuiz.id = `ai_${new Date().getTime()}`;
                onQuizGenerated(generatedQuiz);
                return; // Success, so we exit

            } catch (err) {
                attempt++;
                // Check if it's a retryable error and we haven't exceeded attempts
                if (err.message.includes('Model is overloaded') && attempt < maxRetries) {
                    console.warn(`Attempt ${attempt} failed. Retrying in ${delay / 1000}s...`);
                    setError(`The AI model is busy. Retrying... (Attempt ${attempt + 1}/${maxRetries})`);
                    await sleep(delay);
                    delay *= 2; // Double the delay for the next attempt
                } else {
                    // If it's another error or we've run out of retries, fail permanently
                    console.error("Error generating quiz:", err);
                    setError(`Sorry, something went wrong. ${err.message}`);
                    setIsGenerating(false);
                    return;
                }
            }
        }
        
        // This is only reached if all retries fail
        setError(`The AI model seems to be unavailable right now. Please try again later.`);
        setIsGenerating(false);
    };

    return (
        <div className="fade-in text-center">
            <header className="flex justify-between items-center pb-4 mb-4 border-b">
                 <button onClick={onExit} className="flex items-center gap-1 text-sm text-slate-600 hover:text-sky-600 font-semibold"><ArrowLeftIcon /> Back</button>
                 <h2 className="text-xl font-bold text-center text-slate-800">AI Quiz Generator</h2>
                 <div></div>
            </header>
            <div className="max-w-md mx-auto">
                <h3 className="text-2xl font-bold text-slate-800">Create a New Quiz</h3>
                <p className="text-slate-500 mt-2 mb-6">Select a topic from {subject} to generate a unique 15-question practice exam.</p>
                
                <select 
                    value={selectedTopic}
                    onChange={(e) => setSelectedTopic(e.target.value)}
                    className="w-full p-3 border border-slate-300 rounded-md mb-4 text-lg focus:ring-2 focus:ring-sky-500"
                >
                    <option value="">-- Select a Topic --</option>
                    {availableTopics.map(topic => <option key={topic} value={topic}>{topic}</option>)}
                </select>

                <button 
                    onClick={handleGenerate} 
                    disabled={isGenerating}
                    className="w-full px-8 py-4 bg-sky-600 text-white font-bold rounded-lg shadow-md hover:bg-sky-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors"
                >
                    {isGenerating ? "Generating..." : "Generate Quiz"}
                </button>
                {error && <p className="text-red-500 mt-4">{error}</p>}
            </div>
        </div>
    );
}


// --- RENDER APP ---
const container = document.getElementById('root');
const root = ReactDOM.createRoot(container);
root.render(<App />);

</script>

</body>
</html>